function init(){config={dpr:window.devicePixelRatio,width:640,height:960,isLocal:!0,platform:platformType,isPlayer:"player"===platformType||"mobile"===platformType,isPackage:window.location.protocol.indexOf("file")>-1,version:gameVersion,isUnderConstruction:isUnderConstruction&&-1===window.location.hash.indexOf("user=bb")&&-1===window.location.protocol.indexOf("file")},originalWidth=config.width,originalHeight=config.height,originalWidthCenter=.5*originalWidth,originalHeightCenter=.5*originalHeight,config.isPackage?(config.address="http://speez.herokuapp.com/",config.isPackage=!0):(config.address=window.location.origin+"/",config.isPackage=!1),config.isLocal=config.address.indexOf("localhost")>-1;var a=$("<script>").attr("type","text/javascript").attr("src",config.address+"socket.io/socket.io.js");$("head").append(a);new Audio;game=new Phaser.Game(window.innerWidth,window.innerHeight,Phaser.CANVAS,""),game.stageColor=function(a){return void 0!==a&&(game.stage.backgroundColor=common.getRgb(a)),game.stage.backgroundColor},console.log(config),game.state.add("boot",bootState),config.isUnderConstruction?game.state.add("mail",mailState):(game.state.add("preload",preloadState),game.state.add("main",mainState),game.state.add("player",playerState),game.state.add("playerFinish",playerFinishState),game.state.add("lobby",lobbyState),game.state.add("lobbyPlayer",lobbyPlayerState),game.state.add("stage",stageState),game.state.add("stageFinish",stageFinishState)),game.state.start("boot")}!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","http://www.google-analytics.com/analytics.js","ga"),ga("create","UA-57307032-1","auto"),ga("send","pageview");var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57307032-1"]),_gaq.push(["_trackPageview"]),function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),Animation=function(){function a(){this.groups=[],a.instance=this}return a.prototype.getGroup=function(){var a={id:id,animations:[],pause:!1};return this.groups.push(a),a},a.prototype.create=function(a,b){var c=this.getGroup(b),d=new TimelineLite(a);return d.vars.paused=c.pause,c.push(a),d},a}(),Audio=function(){function a(){this.groups=[],a.instance=this}function b(){var a=this.group,b=a.sounds.indexOf(this);-1!==b&&(a.sounds.splice(b,1),this.destroy())}return a.prototype.addGroup=function(a){var b={id:a,sounds:[],volume:1,mute:!1};return this.groups.push(b),b},a.prototype.getGroup=function(a){var b=_.findWhere(this.groups,{id:a});return b||(b=this.addGroup(a)),b},a.prototype.play=function(a,c,d,e){var f=this.getGroup(a);void 0===d&&(d=f.mute?0:f.volume);var g=game.sound.play(c,d,e);f.sounds.push(g),g.group=f,g.onStop.addOnce(b.bind(g))},a.prototype.stop=function(a){var b=this.getGroup(a);_.each(b.sounds.slice(0),function(a){a.stop()})},a.prototype.volume=function(a,b){var c=this.getGroup(a);c.volume=b,_.each(c.sounds,function(a){a.volume=b})},a.prototype.mute=function(a,b){var c=this.getGroup(a);c.mute=b,_.each(c.sounds,function(a){a.volume=c.mute?0:c.volume})},a}();var com;!function(){com=$.extend({speez:{}},com)}(window);var preloadAvatar,detector,gameOrientation="portrait",originalWidth,originalWidthCenter,originalHeight,originalHeightCenter,config,socket,game,stage,player,world,Layout=com.Layout,gameCount=0,palette=[16766534,105215,15342848,12910830,3595849],avatarNames=["Zumi","Ziki","ZaZok","ZoZo","Zoor","Zeeps","Zot"],common={flipOrientation:function(a){if(console.log("try to flip "+gameOrientation+" to "+a),gameOrientation!==a){"mobile"===config.platform&&screen.lockOrientation(a),console.log("Flipping "+gameOrientation+" to "+a),gameOrientation=a;var b=originalWidth;originalWidth=originalHeight,originalHeight=b,originalWidthCenter=.5*originalWidth,originalHeightCenter=.5*originalHeight}},addZeroes:function(a,b,c){void 0===c&&(c="0");for(var d=a.toString();d.length<b;)d=c+d;return d},createBlankBackground:function(a){void 0===a&&(a=16777215);var b=game.add.sprite(0,0,"background");return b.fixedToCamera=!0,b.scale.setTo(width,height),b.inputEnabled=!0,b.input.priorityID=0,b},generateNames:function(a,b,c,d,e,f){void 0===d&&(d=""),void 0===e&&(e=1),void 0===f&&(f=1);for(var g=[],h=b;c>=h;h+=f){for(var i=h.toString();i.length<e;)i="0"+i;g.push(a+i+d)}return g},drawButton:function(a,b,c,d,e){var f=game.add.sprite(b,c,"button",5);return f.anchor.set(.5,.5),f.text=game.add.text(0,0,a,{font:"40px Arial",fill:"#00ff44",align:"center"}),f.text.anchor.set(.5,.5),f.inputEnabled=!0,f.addChild(f.text),d&&(f.events.onInputOut.add(function(){f.frame=5}),f.events.onInputOver.add(function(){f.frame=1}),e?f.events.onInputDown.addOnce(d):f.events.onInputDown.add(d)),f},tweenTint:function(a,b,c,d){var e={step:0},f=game.add.tween(e).to({step:1},d),g=function(){var d=Phaser.Color.interpolateColor(b,c,1,e.step,0);return"function"==typeof a?void a(d):void 0};return f.onUpdateCallback(g),g(f,0),f.start(),f},tweenStageColor:function(a,b,c){return void 0===c&&(c=.1),TweenLite.to(game,c,{colorProps:{stageColor:a},onComplete:b})},tweenSpin:function(a,b,c){c=_.extend({isClockwise:!0,isEase:!0},c);var d=[];return d[0]=game.add.tween(a).to({angle:c.isClockwise?180:-180},500*b,c.isEase?Phaser.Easing.Back.In:!1,!0),d[1]=game.add.tween(a).to({angle:c.isClockwise?359:-360},500*b,c.isEase?Phaser.Easing.Back.Out:!1,!1),d[0].chain(d[1]),d[1].onComplete.add(function(){a.angle=0}),d},getRgb:function(color){return eval("common."+color)},rgb:function(a,b,c){return(a<<16)+(b<<8)+c},rgba:function(a,b,c,d){return(d<<24)+(a<<16)+(b<<8)+c},toRgb:function(a){return"rgb("+[(16711680&a)>>16,(65280&a)>>8,255&a].join(",")+")"},toRgba:function(a,b){return void 0===b&&(b=0),b+=(4278190080&a)>>20,"rgba("+[(16711680&a)>>16,(65280&a)>>8,255&a].join(",")+", "+b+")"},toRgbHex:function(a,b){void 0===b&&(b="");var c=((16711680&a)>>16).toString(16),d=((65280&a)>>8).toString(16),e=(255&a).toString(16);return c+=1===c.length?"0":"",d+=1===d.length?"0":"",e+=1===e.length?"0":"",b+c+d+e},addHsl:function(a,b,c,d){var e=Phaser.Color.getRGB(a),f=common.rgbToHsl(e.r,e.g,e.b);void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),b=Math.min(Math.max(f.h+b,0),1),c=Math.min(Math.max(f.s+c,0),1),d=Math.min(Math.max(f.l+d,0),1);var g=common.hslToRgb(b,c,d);return common.rgb(g.r,g.g,g.b)},textColorChange:function(){return function(a){return void 0!==a&&(this.fill="#"+common.getRgb(a).toString(16)),this.fill}},graphicsColorChange:function(a,b){return void 0===b&&(b="_fillTint"),function(c){return void 0!==c&&(this.color=common.getRgb(c),this.graphicsData[a][b]=this.color),this.graphicsData[a][b]}},propertyColorChange:function(a){return function(b){return void 0!==b&&(this[a]=common.getRgb(b)),this[a]}},brightness:function(a,b){var c=Phaser.Color.getRGB(a);return c.r=Math.max(0,Math.min(255,c.r+b)),c.g=Math.max(0,Math.min(255,c.g+b)),c.b=Math.max(0,Math.min(255,c.b+b)),common.rgb(c.r,c.g,c.b)},rgbToHsl:function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}},hslToRgb:function(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(0==b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g)}},addLogo:function(a,b){switch(a){case"logo":var c=new com.speez.components.Logo(originalWidth-10,originalHeight-10,originalWidth,originalHeight,{scale:.5});c.logo.anchor.set(1),game.add.existing(c),b.attach(c,{scale:1,width:originalWidth,height:originalHeight,alignHorizontal:Layout.ALIGN_RIGHT,alignVertical:Layout.ALIGN_BOTTOM});break;case"beta":var d=new com.speez.components.Logo(originalWidth,0,originalWidth,originalHeight,{logo:"beta"});d.logo.anchor.set(1,0),game.add.existing(d),b.attach(d,{width:originalWidth,height:originalHeight,alignHorizontal:Layout.ALIGN_RIGHT,alignVertical:Layout.ALIGN_TOP});break;case"feedback":var e={font:"65px FontAwesome",fill:"#000000",align:"center"},f=game.add.text(25,originalHeight-3,"",e);f.inputEnabled=!0,f.events.onInputDown.add(function(){common.open("mailto:broidebrothers@gmail.com?Subject=SPEEZ%20Feedback")}),f.anchor.set(0,1);var g=game.add.text(2*f.width,originalHeight,"",e);g.inputEnabled=!0,g.events.onInputDown.add(function(){common.open("https://www.facebook.com/Speez.co")}),g.anchor.set(0,1);var h=game.add.text(25,originalHeight-g.height,"Feedback - "+config.platform,{font:"25px FontAwesome",fill:"#000000",align:"center"});h.anchor.set(0,1);var i=game.add.sprite();i.addChild(h),i.addChild(f),i.addChild(g),b.attach(i,{width:originalWidth,height:originalHeight,alignHorizontal:Layout.ALIGN_LEFT,alignVertical:Layout.ALIGN_BOTTOM})}},open:function(a,b){var c="_blank";!b&&detector.mobile()&&detector.os().toLowerCase().indexOf("ios")>-1&&navigator.userAgent.toLowerCase().indexOf("safari")>-1&&(c="_parent"),window.open(a,c)}};com.speez.components=_.extend({},com.speez.components),com.speez.components.AchievementBoard=function(){function a(a,b,c,d,e){e=_.extend({x:a,y:b,width:c,height:d,color:4473924,alpha:0,format:{font:"40px Arial",fill:"#eeeeee",stroke:"#111111",align:"center",strokeThickness:10},finalHeight:320,distanceHeight:50,textAppearTime:1,textDelayTime:1,textDissipateTime:.3,dissipateTime:.3,levelCount:3},e),this.options=e,Phaser.Sprite.call(this,game,a,b),this.background=new ColorBox(a,b,c,d,this.options.color),this.background.alpha=this.options.alpha,this.addChild(this.background),this.container=game.add.sprite(0,0),this.addChild(this.container),this.texts=[]}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.show=function(){this.alpha=1,this.hidden=!1},a.prototype.hide=function(){this.hidden=!0,_.each(this.texts,function(a){a.timeline&&a.timeline.kill()}.bind(this));var a=function(){_.invoke(this.texts,"destroy"),this.texts=[]}.bind(this);TweenLite.to(this,this.options.dissipateTime,{alpha:0,onComplete:a})},a.prototype.add=function(a){if(!this.hidden){var a=new Phaser.Text(game,0,0,a,this.options.format);a.alpha=0,a.anchor.set(.5),this.container.addChild(a),this.texts.push(a),this.texts.length>this.options.levelCount||this.setTextAnimation(a)}},a.prototype.setTextAnimation=function(a){a.timeline&&a.timeline.kill();var b=this.texts.indexOf(a),c=new TimelineLite,d=this.options.finalHeight-b*this.options.distanceHeight,e=d/this.options.finalHeight;c.to(a,this.options.textAppearTime,{alpha:e,y:d},0),0===b&&(c.to(a,this.options.textDissipateTime,{alpha:0},"+="+this.options.textDelayTime),c.add(function(){a.destroy(),c.kill()}),c.add(this.setAllTextsAnimations.bind(this),"-="+.75*this.options.textDissipateTime),a.timeline=c)},a.prototype.setAllTextsAnimations=function(){this.texts=_.rest(this.texts),_.each(this.texts,function(a){this.setTextAnimation(a)}.bind(this))},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.AvatarPicker=function(){function a(a){this.head&&this.head.destroy(),this.head=a,this.container.addChild(this.head)}function b(){var a=new Phaser.Sprite(game,0,0,this.options.avatar+"_head");return a.anchor.set(.5),a.alpha=0,a}function c(){this.setEnable(!0)}function d(d){var e=this.rightArrow===d?1:-1,f=this.options.avatarNames.indexOf(this.options.avatar),g=(f+e+this.options.avatarNames.length)%this.options.avatarNames.length;this.options.avatar=this.options.avatarNames[g],this.setEnable(!1),this.changed.dispatch(this.options.avatar);var h=b.call(this),i=new TimelineMax({onComplete:c,onCompleteScope:this});i.to(this.head,.2,{alpha:0,ease:Sine.easeOut}),i.add(function(){a.call(this,h)}.bind(this)),i.to(h,.2,{alpha:1,ease:Sine.easeIn})}return AvatarPicker=function(c,e,f){f=$.extend({avatar:"Zot",arrowFormat:{font:"bold 90px FontAwesome",fill:"#5a5a5c",align:"center"},arrowDistanceX:235,avatarNames:["Zeeps"]},f),this.options=f,Phaser.Sprite.call(this,game,c,e),this.platform=game.add.sprite(0,60,"logoO"),this.platform.anchor.set(.5),this.addChild(this.platform),this.container=game.add.sprite(),this.container.timeline=new TimelineMax({repeat:-1,yoyo:!0}),this.container.timeline.to(this.container,1,{y:"-=20",ease:Power2.easeInOut}),this.addChild(this.container);var g=b.call(this);g.alpha=1,a.call(this,g),this.leftArrow=game.add.text(this.options.arrowDistanceX,0,"",this.options.arrowFormat),this.leftArrow.anchor.set(.5),this.leftArrow.inputEnabled=!0,this.leftArrow.events.onInputDown.add(d,this,-1),this.addChild(this.leftArrow),this.rightArrow=game.add.text(-this.options.arrowDistanceX,0,"",this.options.arrowFormat),this.rightArrow.anchor.set(.5),this.rightArrow.inputEnabled=!0,this.rightArrow.events.onInputDown.add(d,this,1),this.addChild(this.rightArrow),this.changed=new signals.Signal},AvatarPicker.prototype=Object.create(Phaser.Sprite.prototype),AvatarPicker.prototype.constructor=AvatarPicker,AvatarPicker.prototype.change=function(){},AvatarPicker.prototype.setEnable=function(a){this.leftArrow.inputEnabled=a,this.rightArrow.inputEnabled=a},AvatarPicker}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.BlockNumber=function(){return BlockNumber=function(a,b,c,d,e,f){f=$.extend({margin:20,color:0,format:{font:"100px Montserrat",fill:"#ffffff",align:"center"},radius:10},f),this.options=f,Phaser.Sprite.call(this,game,a,b);for(var g=[],h=e,i=0;h>0;i++)g[i]=h%10,h=parseInt(.1*h);g=g.reverse();var j=(c-this.options.margin*(g.length-1))/g.length;this.blocks=[],this.blocksLetters=[];for(var i=0;i<g.length;i++){var k=new Phaser.Graphics(game,i*this.options.margin+i*j);k.beginFill(this.options.color),k.drawRoundedRect(0,0,j,d,this.options.radius);var l=new Phaser.Text(game,k.x+j/2,d/2,g[i].toString(),this.options.format);l.anchor.set(.5),this.blocksLetters.push(l),this.blocks.push(k),this.addChild(k),this.addChild(l)}},BlockNumber.prototype=Object.create(Phaser.Sprite.prototype),BlockNumber.prototype.constructor=BlockNumber,BlockNumber}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.Board=function(){function a(a,b,c,d,e,f){f=_.extend({x:a,y:b,width:c,height:d,color:e,colorTime:.2,brightness:34,darkness:17,cardFormat:{font:"300px Arial",fill:"#ffffff",align:"center"},cardTime:.25,appearTime:2,nameFormat:{font:"80px Arial",fill:"#ffffff",align:"center"},nameHeight:200,nameTime:3,nameFadeInTime:.25,nameFadeOutTime:.25},f),this.options=f,Phaser.Sprite.call(this,game,a,b),this.background=game.add.graphics(),this.background.beginFill(e),this.background.drawRect(0,0,c,d),this.addChild(this.background),this.area=new com.LayoutArea(a,b,c,d,{isDebug:!1}),this.area.attach(this.background,{mode:Layout.STRETCH}),game.add.existing(this),this.container=game.add.sprite(0,0),this.area.attach(this.container,{width:originalWidthCenter,height:originalHeight,mode:Layout.PROPORTIONAL_INSIDE}),this.card=new Phaser.Text(game,.5*c,.5*originalHeight,"",f.cardFormat),this.card.anchor.set(.5),this.container.addChild(this.card)}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,Object.defineProperty(a,"LOCATION_LEFT_TOP",{value:"leftTop"}),Object.defineProperty(a,"LOCATION_LEFT_BOTTOM",{value:"leftBottom"}),Object.defineProperty(a,"LOCATION_RIGHT_TOP",{value:"rightTop"}),Object.defineProperty(a,"LOCATION_RIGHT_BOTTOM",{value:"rightBottom"}),a.prototype.appear=function(a){this.background.graphicsData[0].fillColor=a;var b=new TimelineLite;return b.to(this,this.options.appearTime,{colorProps:{backgroundColor:this.options.color},ease:Bounce.easeOut},0),b},a.prototype.cancelProximity=function(){return TweenLite.to(this,this.options.colorTime,{colorProps:{backgroundColor:this.options.color}},0)},a.prototype.setProximity=function(a){var b=common.brightness(this.options.color,a?this.options.brightness:-this.options.darkness);return TweenLite.to(this,this.options.colorTime,{colorProps:{backgroundColor:b}},0)},a.prototype.tweenColor=function(a,b){return TweenLite.to(this,b,{colorProps:{backgroundColor:a},ease:Sine.easeInOut},0)},a.prototype.backgroundColor=function(a){return void 0!==a&&(this.background.graphicsData[0].fillColor=common.getRgb(a)),this.background.graphicsData[0].fillColor},a.prototype.setCard=function(a,b){var c=new TimelineLite;return c.to(this.card.scale,this.options.cardTime/4,{x:2.5,y:2.5},0),c.addLabel("break",this.options.cardTime/4),c.add(function(){this.card.text=a}.bind(this)),c.to(this.card.scale,3*this.options.cardTime/4,{x:1,y:1,ease:Elastic.easeOut},"break"),void(this.cardTimeline=c)},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.BoardFactory=function(){function a(){this.bitmapDatas=[],a.instance=this}return Object.defineProperty(a,"TYPE_BACK",{value:"back"}),Object.defineProperty(a,"TYPE_BLUR",{value:"blur"}),a.prototype.create=function(b){if(b=_.extend({color:16711680,name:16711680,backRadius:100,blurRadius:50,blurIntensityBegin:0,blurIntensityEnd:1},b),this.bitmapDatas[b.name])return this.bitmapDatas[b.name];this.radius=b.backRadius+b.blurRadius,this.diameter=2*this.radius;var c=game.add.bitmapData(this.diameter,this.diameter);this.createBlur(c,b),this.createBack(c,b),game.cache.addBitmapData(b.name+a.TYPE_BACK,c),this.bitmapDatas[b.name]=!0},a.prototype.createBack=function(a,b){var c=a.context;c.fillStyle=common.toRgb(b.color),c.beginPath(),c.arc(this.radius,this.radius,b.backRadius,0,2*Math.PI,!1),c.fill(),c.closePath()},a.prototype.createBlur=function(a,b){var c=a.context,d=c.createRadialGradient(this.radius,this.radius,1*this.radius,this.radius,this.radius,0*this.radius);d.addColorStop(0,common.toRgba(b.blurColor,b.blurIntensityBegin)),d.addColorStop(1,common.toRgba(b.blurColor,b.blurIntensityEnd)),c.fillStyle=d,c.beginPath(),c.arc(this.radius,this.radius,this.radius+b.blurRadius,0,2*Math.PI,!1),c.fill(),c.closePath()},a.prototype.get=function(a,b){return this.bitmapDatas[a]?game.cache.getBitmapData(a+b):void 0},a.prototype.remove=function(a){this.bitmapDatas[a]&&(delete this.bitmapDatas[a],game.cache.removeBitmapData(a))},a}(),new com.speez.components.BoardFactory;var BoardFactory=com.speez.components.BoardFactory;com.speez.components=_.extend({},com.speez.components),com.speez.components.Card=function(){function a(){this.area.destroy()}function b(){var a=this.x,b=this.currentRatioY,c=game.width*this.options.threshold;return a>this.options.x+c?.5>b?Card.THRESHOLD_RIGHT_TOP:Card.THRESHOLD_RIGHT_BOTTOM:a<this.options.x-c?.5>b?Card.THRESHOLD_LEFT_TOP:Card.THRESHOLD_LEFT_BOTTOM:void 0}return Card=function(b,c,d,e,f,g){g=_.extend({x:0,y:0,index:b,width:e,height:f,radius:20,gapX:5,gapY:5,color:2697513,textColor:16711422,diffusedColor:2171169,diffusedTextColor:2631720,pickUpColor:16777215,pickUpTextColor:65793,pickUpAlpha:1,card:_.random(0,9),overlappedColor:16711422,overlappingAlpha:1,overlapOutlineLineColor:16711422,waitCard:"+",startTime:2,spinTime:1,returnTime:.1,colorTime:.1,placeCardTime:.5,winnerTime:.5,winnerScale:5,overlapCompleteTime:.4,format:{font:"100px Montserrat",align:"center"},isNew:!1,threshold:.1,dragStartCallback:null,dragStopCallback:null,shakeTime:.5,shake:75,heightOffset:35},g),this.thresholdHit=void 0,this.options=g,this.index=b,this.overlap=null,this.card=g.card,this.faceup=!1,Phaser.Sprite.call(this,game,g.x,g.y),game.add.existing(this),this.area=new com.LayoutArea(c,d,e,f,{isDebug:!1}),this.background=new Phaser.Graphics(game),this.background.beginFill(g.diffusedColor);var h=g.width-2*this.options.gapX,i=g.height-2*this.options.gapY;this.background.x=h/2,this.background.y=i/2,this.background.pivot.set(.5*h,.5*i),this.background.drawRoundedRect(this.options.gapX,this.options.gapY,h,i,this.options.radius),this.background.colorChange=common.graphicsColorChange(0),this.backContainer=game.add.sprite(),this.backContainer.addChild(this.background),this.addChild(this.backContainer),this.area.attach(this.backContainer,{width:g.width,height:g.height,mode:Layout.PROPORTIONAL_INSIDE});var j=new Phaser.Graphics(game);j.x=this.background.x,j.y=this.background.y,j.lineWidth=5,j.lineDash=20,j.lineColor=this.options.overlapOutlineLineColor,j.drawRoundedRect(0,0,g.width-2*this.options.gapX,g.height-2*this.options.gapY,this.options.radius),j=game.add.sprite(-10,-10,j.generateTexture()),this.overlapOutline=game.add.sprite(0,0),this.overlapOutline.addChild(j),this.overlapOutline.alpha=0,this.area.attach(this.overlapOutline,{width:g.width,height:g.height,mode:Layout.PROPORTIONAL_INSIDE}),this.addChild(this.overlapOutline);var k=game.add.graphics(0,0);k.drawRect(0,0,g.width,g.height-20),this.solidSprite=game.add.sprite(0,0,k.generateTexture()),this.addChild(this.solidSprite),this.area.attach(this.solidSprite,{width:g.width,height:g.height,mode:Layout.STRETCH}),this.container=game.add.sprite(),this.addChild(this.container),this.area.attach(this.container,{width:g.width,height:g.height}),this.text=new Phaser.Text(game,.5*g.width,.5*g.height,g.waitCard,g.format),this.text.fill="#"+this.options.diffusedTextColor.toString(16),this.text.anchor.set(.5,.5),this.text.colorChange=common.textColorChange(),this.container.addChild(this.text),this.anchor.set(.5,.5),this.enable(!0),this.overlapped=new signals.Signal,this.proximity=new signals.Signal,this.appeared=new signals.Signal,this.background.alpha=0,this.text.alpha=1,this.alpha=.75,this.events.onDestroy.add(a,this)},Card.prototype=Object.create(Phaser.Sprite.prototype),Card.prototype.constructor=Card,Object.defineProperty(Card,"THRESHOLD_NONE",{value:4}),Object.defineProperty(Card,"THRESHOLD_LEFT_TOP",{value:0}),Object.defineProperty(Card,"THRESHOLD_LEFT_BOTTOM",{value:2}),Object.defineProperty(Card,"THRESHOLD_RIGHT_TOP",{value:1}),Object.defineProperty(Card,"THRESHOLD_RIGHT_BOTTOM",{value:3}),Card.prototype.postUpdate=function(){if("+"===this.options.waitCard&&this.input.isDragged){this.background.angle=this.x/game.world.width*100;var a=game.height-this.options.heightOffset*Layout.instance.scaleY,c=this.background.world.y+(.5*this.options.height-this.options.heightOffset)*Layout.instance.scaleY;this.currentRatioY=c/a;var d=b.bind(this)();if(this.thresholdHit!==d&&(this.thresholdHit=d,void 0===d?this.proximity.dispatch(this):(this.proximity.dispatch(this,d),this.overlap=null,this.overlap!==this.index&&this.overlapped.dispatch(this))),void 0===this.thresholdHit){var e=Math.floor(5*this.currentRatioY);(e===this.index||0>e||e>4)&&(e=null),this.overlap!==e&&(this.overlap=e,null===e?this.overlapped.dispatch(this):this.overlapped.dispatch(this,e))}}},Card.prototype.makeDraggable=function(){"+"===this.options.waitCard&&(this.input.enableDrag(!1,!0),this.events.onDragStart.add(this.pickUp.bind(this)),this.options.dragStartCallback&&this.events.onDragStart.add(this.options.dragStartCallback),this.options.dragStopCallback&&this.events.onDragStop.add(this.options.dragStopCallback))},Card.prototype.makeShowCardClick=function(){"+"===this.options.waitCard&&this.events.onInputDown.addOnce(this.appearCard.bind(this))},Card.prototype.startCard=function(){this.options.isNew||this.makeShowCardClick();var a=new TimelineLite;return a},Card.prototype.appearCard=function(){this.events.onInputDown.removeAll();var a=new TimelineLite;return a.add(function(){Audio.instance.play("fx","card/draw")}),a.to(this,this.options.spinTime,{alpha:1},0),a.to(this.background,this.options.spinTime,{alpha:1},0),a.to(this.text,this.options.spinTime,{angle:360,ease:Back.easeInOut},0),a.addLabel("spinHalf",this.options.spinTime/2),a.to(this.background,this.options.spinTime/2,{alpha:1},"spinHalf"),a.to(this.background,this.options.spinTime,{alpha:1,colorProps:{colorChange:this.options.color}},0),a.to(this.text,this.options.spinTime,{alpha:1,colorProps:{colorChange:this.options.textColor}},0),a.add(function(){this.text.text=this.card}.bind(this),"spinHalf"),a.add(this.makeDraggable.bind(this)),a.add(function(){this.faceup=!0,this.appeared.dispatch(this)}.bind(this)),a},Card.prototype.overlapCard=function(a){this.card=a,this.text.angle=0;var b=new TimelineLite;return b.to(this.text,this.options.spinTime,{angle:360,ease:Back.easeInOut}),b.addLabel("spinHalf",this.options.spinTime/2),b.to(this.background,this.options.spinTime/2,{colorProps:{colorChange:this.options.color}},"spinHalf"),b.add(function(){this.text.text=this.card}.bind(this),"spinHalf"),b.to(this.text.scale,this.options.spinTime,{x:1,y:1},0),b},Card.prototype.cancelProximity=function(){return TweenLite.to(this.background,this.options.colorTime,{colorProps:{colorChange:this.options.pickUpColor}})},Card.prototype.setProximity=function(a){return TweenLite.to(this.background,this.options.colorTime,{colorProps:{colorChange:a}})},Card.prototype.cancelOverlapped=function(){var a=new TimelineLite;return a.to(this.text.scale,this.options.colorTime,{x:1,y:1}),a.to(this.background,this.options.colorTime,{colorProps:{colorChange:this.options.color}}),a},Card.prototype.setOverlapped=function(){var a=new TimelineLite;return a.to(this.background,this.options.colorTime,{colorProps:{colorChange:this.options.overlappedColor}}),a},Card.prototype.cancelOverlapping=function(){return TweenLite.to(this,this.options.colorTime,{alpha:this.options.pickUpAlpha})},Card.prototype.setOverlapping=function(){return TweenLite.to(this,this.options.colorTime,{alpha:this.options.overlappingAlpha})},Card.prototype.cancelOverlapSighted=function(){var a=new TimelineLite;return a.to(this.overlapOutline,this.options.colorTime,{alpha:0}),a},Card.prototype.setOverlapSighted=function(){var a=new TimelineLite;return a.to(this.overlapOutline,this.options.colorTime,{alpha:1}),a},Card.prototype.pickUp=function(){this.destroyTweens();var a=new TimelineLite;return a.to(this.background,this.options.colorTime,{colorProps:{colorChange:this.options.pickUpColor}}),a.to(this,this.options.colorTime,{alpha:this.options.pickUpAlpha},0),a.to(this.text,this.options.colorTime,{colorProps:{colorChange:this.options.pickUpTextColor}}),a},Card.prototype.returnCard=function(){this.destroyTweens();var a=new TimelineLite;return a.to(this.background,this.options.colorTime,{angle:0,colorProps:{colorChange:this.options.color}}),a.to(this,this.options.returnTime,{x:this.options.x,y:this.options.y,alpha:1},0),a.to(this.text,this.options.returnTime,{colorProps:{colorChange:this.options.textColor}},0),a},Card.prototype.placeCardBoard=function(){var a;a=this.thresholdHit===Card.THRESHOLD_LEFT_BOTTOM||this.thresholdHit===Card.THRESHOLD_LEFT_TOP?-1e3:game.width+500;var b=new TimelineLite;return b.to(this,this.options.placeCardTime,{x:a,alpha:0}),b},Card.prototype.placeCardOverlap=function(){var a=this.overlap-this.index,b=a*this.options.height*Layout.instance.scaleY,c=new TimelineLite;return c.to(this,this.options.placeCardTime,{x:this.options.x,y:b,alpha:0}),c},Card.prototype.overlapComplete=function(){var a=new TimelineLite;return a.to(this.background,this.options.overlapCompleteTime,{colorProps:{colorChange:this.options.textColor}}),a.to(this.background,this.options.overlapCompleteTime,{colorProps:{colorChange:this.options.color}}),a},Card.prototype.reject=function(){this.faceup&&(this.destroyTweens(),this.alpha=1,this.x=this.options.x,this.y=this.options.y,this.text.alpha=1,this.text.fill="#"+this.options.textColor.toString(16),this.text.scale.set(1,1),this.background.angle=0,this.background.graphicsData[0].fillColor=this.options.color,this.overlapOutline.alpha=0)},Card.prototype.destroyTweens=function(){TweenLite.killTweensOf(this),TweenLite.killTweensOf(this.text),TweenLite.killTweensOf(this.background)},Card.prototype.shake=function(a,b){game.world.sendToBack(this);var c=new TimelineLite,d=[this.options.x+this.options.shake,this.options.x-this.options.shake];c.to(this,this.options.shakeTime,{x:d[a?0:1],ease:Elastic.easeOut}),c.to(this,this.options.shakeTime,{x:d[a?1:0],ease:Elastic.easeOut},"-="+3*this.options.shakeTime/4),c.to(this,this.options.shakeTime,{x:this.options.x,ease:Elastic.easeOut},"-="+3*this.options.shakeTime/4);var e=c.duration();return c.to(this.background,e/4,{colorProps:{colorChange:b}},0),c.to(this.background,e/4,{colorProps:{colorChange:this.options.color}},e/4),c.timeScale(1.5),c},Card.prototype.playWinnerStart=function(){var a=new TimelineLite;return a.to(this.background,this.options.colorTime,{alpha:0}),a},Card.prototype.playWinner=function(){var a=new TimelineLite;return a.to(this.text.scale,this.options.winnerTime/4,{x:this.options.winnerScale,y:this.options.winnerScale},0),a.to(this.text,this.options.winnerTime/4,{colorProps:{colorChange:_.random(5592405,13421772)}},0),a.addLabel("break",this.options.winnerTime/4),a.to(this.text.scale,3*this.options.winnerTime/4,{x:1,y:1,ease:Elastic.easeOut},"break"),a.to(this.text,3*this.options.winnerTime/4,{colorProps:{colorChange:15658734}},"break"),a},Card.prototype.unattach=function(){this.area.unattach(this.container)},Card.prototype.enable=function(a){"+"===this.options.waitCard&&(this.inputEnabled=a)},Card}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.ColorBox=function(){return ColorBox=function(a,b,c,d,e,f){f=$.extend({width:c,height:d,color:e,text:"",format:{font:"24px Arial",fill:"#eeeeee",align:"center"},anchorX:1,anchorY:1,textColorMode:ColorBox.TEXT_COLOR_MODE_NONE},f),this.options=f;var g=new Phaser.Rectangle(c*(f.anchorX-1),d*(f.anchorY-1),c,d);Phaser.Sprite.call(this,game,a,b),this.anchor.set(f.anchorX,f.anchorY),this.background=new Phaser.Graphics(game),this.background.beginFill(f.color),this.background.drawRect(g.x,g.y,g.width,g.height),this.box=this.background.graphicsData[0],this.addChild(this.background),this.text=new Phaser.Text(game,.5*c+g.x,.5*d+g.y,f.text,f.format),this.text.anchor.set(.5),this.addChild(this.text),this.changed=new signals.Signal},Object.defineProperty(ColorBox,"TEXT_COLOR_MODE_NONE",{value:"none"}),Object.defineProperty(ColorBox,"TEXT_COLOR_MODE_NEGATIVE",{value:"negative"}),ColorBox.prototype=Object.create(Phaser.Sprite.prototype),ColorBox.prototype.constructor=ColorBox,ColorBox.prototype.setText=function(a){this.text.text=a},ColorBox.prototype.setColor=function(a){var b=Phaser.Color.getRGB(a),c=["rgb(",b.r,",",b.g,",",b.b,")"].join("");this.backgroundColor(c)},ColorBox.prototype.backgroundColor=function(a){if(void 0!==a){if(this.color=common.getRgb(a),this.box.fillColor=this.color,this.options.textColorMode===ColorBox.TEXT_COLOR_MODE_NEGATIVE){var b=Phaser.Color.getRGB(this.color);this.text.fill=Phaser.Color.RGBtoString(255-b.r,255-b.g,255-b.b,255,"#")}this.changed.dispatch(this.color)}return this.box.fillColor},ColorBox.prototype.tweenColor=function(a,b){return this.tween=TweenLite.to(this,b,{colorProps:{backgroundColor:a}}),this.tween},ColorBox}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.Header=function(){function a(a,b,c){c=_.extend({width:a,height:b,text:"",format:{font:"50px Montserrat",align:"center"},textColor:16777215,color:16777215,alpha:1},c),this.options=c,this.options.format.fill="#"+common.toRgbHex(c.textColor),Phaser.Sprite.call(this,game,0,0),game.add.existing(this),this.background=new ColorBox(0,0,a,b,c.color),this.background.alpha=this.options.alpha,this.addChild(this.background),this.headerArea=new com.LayoutArea(0,0,a,b,{isDebug:!1}),this.headerArea.attach(this.background,{width:a,height:b,mode:Layout.STRETCH}),this.center=game.add.sprite(),this.headerArea.attach(this.center,{width:10,height:b,mode:Layout.PROPORTIONAL_INSIDE,alignHorizontal:Layout.ALIGN_CENTER}),this.title=game.add.text(0,.38*b,c.text,c.format),this.title.anchor.set(.5),this.center.addChild(this.title),this.left=game.add.sprite(),this.headerArea.attach(this.left,{mode:Layout.PROPORTIONAL_INSIDE,alignHorizontal:Layout.ALIGN_LEFT,width:10,height:b}),this.right=game.add.sprite(),this.headerArea.attach(this.right,{mode:Layout.PROPORTIONAL_INSIDE,alignHorizontal:Layout.ALIGN_RIGHT,width:10,height:b}),this.addChild(this.center),this.addChild(this.left),this.addChild(this.right)
}return Object.defineProperty(a,"CENTER",{value:"center"}),Object.defineProperty(a,"RIGHT",{value:"right"}),Object.defineProperty(a,"LEFT",{value:"left"}),a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.setText=function(a){this.options.text=a,this.timeline&&this.timeline.isActive()||(this.title.text=a)},a.prototype.add=function(){},a.prototype.addCenter=function(a,b){b=_.extend({marginLeft:10,marginRight:10,marginTop:10,marginDown:10},b),this.center.addChild(a)},a.prototype.addLeft=function(a,b){b=_.extend({marginLeft:10,marginRight:10,marginTop:10,marginDown:10},b),this.left.addChild(a)},a.prototype.addRight=function(a,b){b=_.extend({marginLeft:10,marginRight:10,marginTop:10,marginDown:10},b),this.right.addChild(a)},a.prototype.tweenTitle=function(a,b,c){var d=new TimelineLite;return d.to(this.title,c,{alpha:0}),d.add(this.background.tweenColor(b,2*c),0),d.add(function(){return null===a?void(this.title.text=this.options.text):void(this.title.text=a)}.bind(this)),d.to(this.title,c,{alpha:1}),d},a.prototype.tweenTitleDelay=function(a,b,c,d){this.timeline&&(this.timeline.kill(),this.timeline=null);var e=new TimelineLite;e.add(this.tweenTitle(a,b,c)),e.add(this.tweenTitle(null,this.options.color,c),"+="+d),this.timeline=e},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.Incoming=function(){function a(a,b,c){c=_.extend({},c),c=c,Phaser.Sprite.call(this,game,a,b),game.add.existing(this),this.timelines=[]}function b(a,b,c){this.timelines.splice(this.timelines.indexOf(c),1),c.kill(),b.destroy(),a.complete&&a.complete()}function c(){this.destroy()}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.makeTexts=function(a,b){return _.map(a,function(a){var c=new Phaser.Text(game,0,0,a.text,b);return c.anchor.set(.5),c.anchor.set(.5),c.scale.set(0),c.sound=a.sound,a.angle&&(c.angle=a.angle),c}.bind(this))},a.prototype.stop=function(){_.each(this.timelines,function(a){a.kill()});var a=new TimelineLite({onComplete:c,onCompleteScope:this});return a.to(this,1,{alpha:0}),a},a.prototype.show=function(a,c){c=_.extend({format:{font:"200px Montserrat",fill:"#111111",align:"center"},isTexts:!1,size:150,delay:0,textAngleTime:1,textAngleDelay:.4,itemInTime:1.5,itemOutTime:1,inTime:1,outTime:1.5,delayBetween:1,timeScale:1},c),c.effectOptions=_.extend({},c.effectOptions),c.effectAnimationOptions=_.extend({},c.effectAnimationOptions),c.isTexts&&(a=this.makeTexts(a,c.format));var d=game.add.sprite();this.addChild(d);var e=new com.speez.components.IncomingEffect(c.effectOptions);d.addChild(e);var f=new TimelineMax({onComplete:b,onCompleteScope:this});f.vars.onCompleteParams=[c,d,f];for(var g=0;g<a.length;g++){var h=a[g],i=game.add.graphics();i.beginFill(16777215),i.drawCircle(0,0,c.size);var j=game.add.sprite();j.addChild(i),j.addChild(h),j.scale.set(0),d.addChild(j);var k=new TimelineMax;k.to(h,c.textAngleTime,{angle:0,ease:Sine.easeOut},c.textAngleDelay),k.to(h.scale,c.itemInTime,{x:1,y:1,ease:Sine.easeOut},0),k.addLabel("itemShrink"),k.to(h.scale,c.itemOutTime,{x:0,y:0,ease:Sine.easeIn},"itemShrink"),k.to(j.scale,c.inTime,{x:1,y:1,ease:Sine.easeOut},0),k.addLabel("shrink",c.inTime),k.to(j.scale,c.outTime,{x:0,y:0,ease:Sine.easeIn},"shrink"),f.addLabel("time"+g,"+="+(0===g?0:c.delayBetween)),f.add(k,"time"+g),f.add(e.animate(c.effectAnimationOptions),"time"+g)}return f.timeScale(c.timeScale),this.timeline=f,this.timelines.push(f),f},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.IncomingEffect=function(){function a(a){a=_.extend({size:150,color:31743,inTime:1,outTime:1,count:4,blurRadius:175,backRadius:350,blurColor:4456703,name:"effect"},a),this.options=a,Phaser.Sprite.call(this,game,0,0),BoardFactory.instance.create({color:this.options.color,name:this.options.name,blurRadius:this.options.blurRadius,backRadius:this.options.backRadius,blurColor:this.options.blurColor}),this.circles=[],this.circlesScales=[];for(var c=0;c<this.options.count;c++){var d=game.add.sprite(0,0,BoardFactory.instance.get(this.options.name,BoardFactory.TYPE_BACK));d.anchor.set(.5),d.scale.set(0),this.addChild(d),this.circles[c]=d,this.circlesScales[c]=d.scale}this.events.onDestroy.add(b,this)}function b(){BoardFactory.instance.remove(this.options.name)}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.animate=function(a){a=_.extend({scales:[1,.75,.55,.4],inTimes:[1,1.4,1.5,1.45],outTimes:[1,.5,.5,.5],delays:[.4,.4,.4,.4]},a);for(var b=new TimelineMax({}),c=0;c<this.circles.length;c++){var d=this.circles[c];b.fromTo(d.scale,a.inTimes[c],{x:0,y:0},{delay:a.delays[c],x:a.scales[c],y:a.scales[c],ease:Sine.easeOut},0),b.to(d.scale,a.outTimes[c],{x:0,y:0,ease:Sine.easeIn},a.inTimes[c]+a.delays[c])}return b},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.Logo=function(){return Logo=function(a,b,c,d,e){e=$.extend({logo:"bblogo",scale:.7},e),this.options=e,Phaser.Sprite.call(this,game,0,0),this.logo=game.add.sprite(a,b,this.options.logo),this.logo.scale.set(this.options.scale),this.addChild(this.logo)},Logo.prototype=Object.create(Phaser.Sprite.prototype),Logo.prototype.constructor=Logo,Logo}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.MenuButton=function(){function a(){this.enable&&this.tweenColor(this.options.color,this.options.textColor)}function b(){this.enable&&this.tweenColor(this.options.colorOver,this.options.textColorOver)}function c(){this.enable&&this.tweenColor(this.options.colorDown,this.options.textDownColor)}function d(){this.enable&&this.tweenColor(this.options.color,this.options.textColor)}function e(){TweenMax.killTweensOf(this.background),TweenMax.killTweensOf(this.text)}function f(){this.enable&&this.options.callback&&this.options.callback.call(this)}MenuButton=function(g,h,i,j,k){k=$.extend({format:{font:"24px Arial",fill:"#000000",align:"center"},textColor:0,color:14803425,textColorOver:14803425,colorOver:0,textColorDown:0,colorDown:16777215,isOnce:!1,radius:0,borderColor:0,borderWidth:0,colorTime:.2,text:""},k),this.options=k,this.options.format.fill="#"+common.toRgbHex(this.options.textColor);var l=new Phaser.Graphics(game);l.drawRect(0,0,i,j),Phaser.Sprite.call(this,game,g,h,l.generateTexture()),this.anchor.set(.5),this.background=new Phaser.Graphics(game,-i/2,-j/2),this.background.beginFill(this.options.color),this.background.lineWidth=this.options.borderWidth,this.background.lineColor=this.options.borderColor,this.background.drawRoundedRect(0,0,i,j,this.options.radius),this.background.colorChange=common.graphicsColorChange(0),this.addChild(this.background),this.text=new Phaser.Text(game,0,0,this.options.text,this.options.format),this.text.anchor.set(.5),this.text.colorChange=common.textColorChange(),this.addChild(this.text),this.inputEnabled=!0,this.events.onInputOut.add(a,this),this.events.onInputOver.add(b,this),this.events.onInputDown.add(c,this),this.events.onInputUp.add(d,this),k.isOnce?this.events.onInputUp.addOnce(f,this):this.events.onInputUp.add(f,this),this.enable=!0,this.events.onDestroy.add(e,this)},MenuButton.prototype=Object.create(Phaser.Sprite.prototype),MenuButton.prototype.constructor=MenuButton,MenuButton.prototype.setColor=function(a){this.background.change({color:a})},MenuButton.prototype.setText=function(a){this.text.text=a},MenuButton.prototype.tweenColor=function(a,b){var c=new TimelineMax;return c.to(this.background,this.options.colorTime,{colorProps:{colorChange:a}}),c.to(this.text,this.options.colorTime,{colorProps:{colorChange:b}},0),c},MenuButton.prototype.setEnable=function(a){this.enable=a}}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.ParticleFactory=function(){function a(){this.classes=[],a.instance=this}return a.prototype.create=function(a){if(a=_.extend({size:24,color:16711680,name:"rectangleParticles",makeFunction:this.defaultMakeParticles},a),a.makeFunction(a),this.classes[name])return this.classes[name];var b=function(b,c,d){Phaser.Particle.call(this,b,c,d,b.cache.getBitmapData(a.name))};return b.prototype=Object.create(Phaser.Particle.prototype),b.prototype.constructor=b,b},a.prototype.defaultMakeParticles=function(a){var b=game.add.bitmapData(a.size,a.size);b.context.fillStyle=common.toRgb(a.color),b.context.fillRect(0,0,a.size,a.size),game.cache.addBitmapData(a.name,b)},a}(),new com.speez.components.ParticleFactory;var ParticleFactory=com.speez.components.ParticleFactory;com.speez.components=_.extend({},com.speez.components),com.speez.components.PauseScreen=function(){function a(a,c,d){d=_.extend({color:1973790},d),this.options=d,Phaser.Sprite.call(this,game,0,0),this.area=new com.LayoutArea(0,0,a,c,{isDebug:!1}),this.background=game.add.graphics(),this.background.beginFill(this.options.color),this.background.drawRect(0,0,a,c),this.addChild(this.background),this.area.attach(this.background,{mode:Layout.STRETCH,width:a,height:c}),this.container=game.add.sprite(),this.addChild(this.container),this.area.attach(this.container,{width:a,height:c}),this.events.onDestroy.add(b,this)}function b(){this.area.destroy()}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.postUpdate=function(){game.world.bringToTop(this)},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.PlayerBoard=function(){function a(a,b,c,d,e,f){f=_.extend({radius:c,gap:30,color:e,arrowTime:.5,diffuseAlpha:.3,onAlpha:1,halfAlpha:.6,proximityTime:.2,appearTime:1},f),this.options=f,Phaser.Sprite.call(this,game,a,b),game.add.existing(this),this.isLeft=0===a,this.background=game.add.graphics(),this.background.x=this.isLeft?2*-(f.radius+f.gap):2*(f.radius+f.gap),this.background.y=d/2,this.background.beginFill(this.options.color),this.background.fillAlpha=f.diffuseAlpha,this.background.drawCircle(0,0,f.radius),this.background.circle=this.background.graphicsData[0],this.addChild(this.background),this.backgroundOutline=new Phaser.Graphics(game),this.backgroundOutline.lineStyle(5,this.options.color,1,[10]),this.backgroundOutline.drawCircle(0,0,f.radius),this.backgroundOutline.angle=this.isLeft?180:0,this.backgroundOutline.cacheAsBitmap=!0,this.backgroundOutline=game.add.sprite(this.background.x,d/2,this.backgroundOutline.generateTexture()),this.backgroundOutline.anchor.set(.5),this.addChild(this.backgroundOutline),this.text=new Phaser.Text(game,.5*c,.5*d,"",{font:"75px FontAwesome",align:"center",fill:"#"+common.toRgbHex(f.color)}),this.text.anchor.set(.5,.5),this.text.colorChange=common.textColorChange(),this.text.visible=!1,this.text.text=this.isLeft?"":"",this.addChild(this.text),this.area=new com.LayoutArea(a,b,c,d,{isDebug:!1}),this.area.attach(this,{mode:Layout.PROPORTIONAL_INSIDE,width:c,height:d,alignHorizontal:this.isLeft?Layout.ALIGN_LEFT:Layout.ALIGN_RIGHT}),this.effectOptions={count:3,backRadius:1*f.radius,blurRadius:50},this.animationOptions={delays:[0,0,0],inTimes:[.4,.5,.6],outTimes:[.6,.5,.4],scales:[1,.8,.6]}}function b(){var a=.5*this.options.radius+(this.isLeft?-5:5);this.arrowTimeline=new TimelineMax({repeat:-1}),this.arrowTimeline.fromTo(this.text,this.options.arrowTime,{x:a},{x:.5*this.options.radius+(this.isLeft?-20:20),ease:Back.easeOut}),this.arrowTimeline.to(this.text,this.options.arrowTime,{x:a,ease:Back.easeOut})}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.destroyTween=function(){this.timeline&&this.timeline.kill()},a.prototype.setArrow=function(){this.text.visible=!0},a.prototype.cancelArrow=function(){this.text.visible=!1},a.prototype.setCard=function(){return TweenLite.to(this.background.circle,this.options.proximityTime,{fillAlpha:1},0)},a.prototype.cancelCard=function(){return TweenLite.to(this.background.circle,this.options.proximityTime,{fillAlpha:this.options.diffuseAlpha},0)},a.prototype.setCardSuccess=function(){var a=new com.speez.components.IncomingEffect(_.extend({color:this.options.color,name:"board"+this.options.color.toString(16),blurColor:common.addHsl(this.options.color,.1)},this.effectOptions));a.x=this.background.x,a.y=this.background.y,this.addChildAt(a,0);var b=a.animate(this.animationOptions);return b.timeScale(2.2),b},a.prototype.setProximity=function(a){return a?TweenLite.to(this.background.circle,this.options.proximityTime,{fillAlpha:this.options.halfAlpha},0):void 0},a.prototype.cancelProximity=function(){return TweenLite.to(this.background.circle,this.options.proximityTime,{fillAlpha:this.options.diffuseAlpha},0)},a.prototype.appear=function(){var a=new TimelineLite;return a.fromTo([this.background,this.backgroundOutline],this.options.appearTime,{x:this.isLeft?2*-(this.options.radius+this.options.gap):2*(this.options.radius+this.options.gap)},{x:this.isLeft?-this.options.gap:this.options.radius+this.options.gap,ease:Sine.easeOut}),a.add(b.bind(this)),a},a.prototype.disappear=function(){var a=new TimelineLite;return a.fromTo([this.background,this.backgroundOutline],this.options.appearTime,{x:this.isLeft?-this.options.gap:this.options.radius+this.options.gap},{x:this.isLeft?2*-(this.options.radius+this.options.gap):2*(this.options.radius+this.options.gap),ease:Sine.easeIn}),a.to(this,this.options.appearTime,{alpha:0},0),a},a.prototype.postUpdate=function(){this.backgroundOutline.angle+=.2},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.PlayerCardBar=function(){function a(a,b,c,d,e){e=_.extend({format:{font:"75px FontAwesome",align:"center",fill:"#fefefe"},color:0,colorForeground:16711422,lastOneTime:.2,lastFiveTime:.5,colorLastOne:12268339,colorLastFive:3390259},e),this.options=e,Phaser.Sprite.call(this,game,a,b),game.add.existing(this),this.foreground=game.add.graphics(),this.foreground.beginFill(this.options.colorForeground),this.foreground.drawRect(0,0,c,d),this.foreground.rect=this.foreground.graphicsData[0],this.foreground.colorChange=common.graphicsColorChange(0),this.foregroundSprite=game.add.sprite(),this.foregroundSprite.addChild(this.foreground),this.addChild(this.foregroundSprite),this.area=new com.LayoutArea(a,b,c,d,{isDebug:!1}),this.area.attach(this.foregroundSprite,{mode:Layout.STRETCH,width:c,height:d}),this.flashLastTimeline=new TimelineMax({paused:!0,repeat:-1,yoyo:!0}),this.flashLastTimeline.to(this.foreground,this.options.lastOneTime,{alpha:0}),this.flashLastFiveTimeline=new TimelineMax({paused:!0,repeat:-1,yoyo:!0}),this.flashLastFiveTimeline.to(this.foreground,this.options.lastFiveTime,{alpha:0}),this.events.onDestroy.add(this.onDestroy.bind(this))}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.setProgress=function(a){this.foreground.scale.set(a,1)},a.prototype.flash=function(a){this.alpha=1,this.flashLastTimeline.stop(),this.flashLastFiveTimeline.stop(),1===a?this.flashLastTimeline.play():5===a&&this.flashLastFiveTimeline.play()},a.prototype.onDestroy=function(){this.flashLastTimeline.kill(),this.flashLastFiveTimeline.kill()},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.PlayerFullScreen=function(){function a(a,b,c,d,e){e=_.extend({gapY:50,textGapY:0,textGapX:100,symbolGapY:250,width:c,height:d},e),this.options=e,Phaser.Sprite.call(this,game,a,b),game.add.existing(this),this.background=game.add.graphics(),this.background.drawRect(0,0,c,d),this.background.rect=this.background.graphicsData[0],this.addChild(this.background),this.container=game.add.sprite(),this.addChild(this.container),this.textContainer=game.add.sprite(),this.textContainer.x=0,this.textContainer.y=this.options.gapY,this.container.addChild(this.textContainer),this.area=new com.LayoutArea(a,b,c,d,{isDebug:!1}),this.area.attach(this.background,{mode:Layout.STRETCH,width:c,height:d}),this.area.attach(this.container,{width:c,height:d}),this.events.onDestroy.add(this.onDestroy.bind(this))}function b(a,b){this.texts=[];var c=0;_.each(a,function(a){var b=new Phaser.Text(game,this.options.textGapX,c,a.text,{font:"125px arial",align:"right",fill:"#"+common.toRgbHex(a.color)});b.anchor.set(0,0),c+=b.height+this.options.textGapY,this.textContainer.addChild(b)}.bind(this)),c+=this.options.symbolGapY,this.symbol=new Phaser.Text(game,this.options.width/2,c,b.text,{font:"350px FontAwesome",align:"center",fill:"#"+common.toRgbHex(b.color)}),this.symbol.anchor.set(.5),this.textContainer.addChild(this.symbol)}function c(){game.world.bringToTop(this)}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.show=function(a,d,e){return e=_.extend({color:16711680,fadeInTime:.2,fadeOutTime:.2,delayTime:3,alpha:.8},e),this.background.rect.fillColor=e.color,this.background.alpha=0,this.textContainer.alpha=0,b.bind(this)(a,d),this.timelineShow&&this.timelineShow.kill(),this.timelineShow=new TimelineMax({onStart:c.bind(this),onComplete:this.onDestroy.bind(this)}),this.timelineShow.to(this.background,e.fadeInTime,{alpha:e.alpha}),this.timelineShow.to(this.textContainer,e.fadeInTime,{alpha:e.alpha},0),this.timelineShow.addLabel("delay","+="+e.delayTime),e.complete&&this.timelineShow.add(e.complete,"delay"),this.timelineShow.to([this.background,this.textContainer],e.fadeOutTime,{alpha:0},"delay"),this.timelineShow},a.prototype.onDestroy=function(){this.timelineShow&&this.timelineShow.kill()},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.PlayerIcon=function(){function a(){var a=90,b=60,c=-30,d=30;this.victoriesSymbol=game.add.text(c,a,"",this.options.symbolFormat),this.victoriesSymbol.alpha=0,this.victoriesSymbol.anchor.set(.5),this.addChild(this.victoriesSymbol),this.victories=game.add.text(d,a,"0",this.options.achievementsFormat),this.victories.alpha=0,this.victories.anchor.set(.5),this.addChild(this.victories),this.blocksSymbol=game.add.text(c,a+b,"",this.options.symbolFormat),this.blocksSymbol.alpha=0,this.blocksSymbol.anchor.set(.5),this.addChild(this.blocksSymbol),this.blocks=game.add.text(d,a+b,"0",this.options.achievementsFormat),this.blocks.alpha=0,this.blocks.anchor.set(.5),this.addChild(this.blocks),this.faztSymbol=game.add.text(c,a+2*b,"",this.options.symbolFormat),this.faztSymbol.alpha=0,this.faztSymbol.anchor.set(.5),this.addChild(this.faztSymbol),this.fazt=game.add.text(d,a+2*b,"0",this.options.achievementsFormat),this.fazt.alpha=0,this.fazt.anchor.set(.5),this.addChild(this.fazt)}function b(a){a.destroy()}function c(){this.stopAvatarAnimation&&this.avatar.timeline.pause()}function d(){this.avatar=game.add.sprite(0,100,this.player.avatar),this.avatar.anchor.set(.5,.75),this.avatar.events.onDestroy.add(i,this),this.addChildAt(this.avatar,this.children.indexOf(this.background)),this.addChild(this.avatarMask),this.avatar.mask=this.avatarMask}function e(){this.avatar.timeline&&this.avatar.timeline.kill(),this.avatar.destroy(),this.removeChild(this.avatarMask)}function f(){this.avatar.timeline=new TimelineMax({yoyo:!0,repeat:-1}),this.avatar.timeline.add(c.bind(this)),this.avatar.timeline.to(this.avatar,this.options.avatarSpeed,{y:"+="+this.options.avatarJumpY,ease:Sine.easeInOut})}function g(){f.call(this)}function h(){e.call(this)}function i(){this.avatar.timeline&&this.avatar.timeline.kill()}function j(){this.points.text=Math.ceil(this.currentPoints).toString()}function k(a){this.colorTimeline&&this.colorTimeline.kill(),this.colorTimeline=a}PlayerIcon=function(b,c,d,e,f){f=$.extend({width:d,height:e,nameFormat:{font:"bold 25px Montserrat",fill:"#000000",align:"center"},pointsFormat:{font:"20px Montserrat",fill:"#000000",align:"center"},changeNameTime:1,setPlayerFadeOutTime:.75,setPlayerFadeInTime:.75,playerColor:16777215,joinColor:8355711,joinFormat:{font:"35px Montserrat",fill:"#ffffff",align:"center"},radius:10,achievementsFormat:{font:"35px Montserrat",fill:"#000000",align:"center"},symbolFormat:{font:"40px FontAwesome",fill:"#000000",align:"center"},isShowStats:!0,colorTime:.5,avatarStartY:100,avatarTargetY:-10,avatarAngle:10,avatarJumpY:-5,avatarSpeed:.6,appearTime:1,disappearTime:1,pointsTime:1,cardCountBarProgress:0,cardCountBarHeight:10,cardCountBarMargin:1,cardCountBarColor:0,cardCountBarAlpha:.6,cardCountBarRadius:5},f),this.options=f,Phaser.Sprite.call(this,game,b,c),game.add.existing(this),this.avatarMask=new Phaser.Graphics(game),this.avatarMask.beginFill(0),this.avatarMask.drawRect(-d,2*-e,2*this.options.width,2*this.options.height),this.background=new Phaser.Graphics(game),this.background.beginFill(this.options.joinColor),this.background.changeColor=common.graphicsColorChange(0),this.background.drawRoundedRect(-d/2,-e/2,d,e,this.options.radius),this.addChild(this.background),this.join=game.add.text(0,0,"Join",f.joinFormat),this.join.anchor.set(.5),this.addChild(this.join),this.name=game.add.text(0,-18,"",f.nameFormat),this.name.alpha=0,this.name.anchor.set(.5),this.addChild(this.name),this.points=game.add.text(0,8,"0",f.pointsFormat),this.points.alpha=0,this.points.anchor.set(.5),this.addChild(this.points),this.cardCountBar=new Phaser.Graphics(game,-this.options.width/2,this.options.height/2-(this.options.cardCountBarMargin+this.options.cardCountBarHeight)),this.cardCountBar.alpha=this.options.cardCountBarAlpha,this.cardCountBar.beginFill(this.options.cardCountBarColor),this.cardCountBar.drawRoundedRect(0,-this.options.cardCountBarMargin,this.options.width,this.options.cardCountBarHeight,this.options.cardCountBarRadius),this.cardCountBar.colorChange=common.graphicsColorChange(0),this.cardCountBar.graphicsData[0].shape.width=this.options.width*this.options.cardCountBarProgress,this.addChild(this.cardCountBar),this.emitter=game.add.emitter(0,0,100);var g=300;this.emitter.setXSpeed(-g,g),this.emitter.setYSpeed(-g,g),this.emitter.gravity=200,this.addChild(this.emitter),this.options.isShowStats&&a.call(this)},PlayerIcon.prototype=Object.create(Phaser.Sprite.prototype),PlayerIcon.prototype.constructor=PlayerIcon,PlayerIcon.prototype.setToJoin=function(){this.player=null;var a=new TimelineMax;return a.to([this.name,this.points],this.options.setPlayerFadeInTime,{alpha:0},0),this.options.isShowStats&&a.to([this.victories,this.blocks,this.fazt,this.victoriesSymbol,this.blocksSymbol,this.faztSymbol],this.options.setPlayerFadeInTime,{alpha:0},0),a.to(this.avatar,this.options.setPlayerFadeInTime,{y:this.options.avatarStartY}),a.add(h.bind(this)),a.addLabel("fade"),a.to(this.background,this.options.setPlayerFadeOutTime,{colorProps:{changeColor:this.options.joinColor}}),a.to(this.join,this.options.setPlayerFadeOutTime,{alpha:1},0),a},PlayerIcon.prototype.removePlayer=function(){this.player=null;var a=new TimelineMax({onComplete:h,onCompleteScope:this});return a.to([this.name,this.points],this.options.setPlayerFadeInTime,{alpha:0},0),this.options.isShowStats&&a.to([this.victories,this.blocks,this.fazt,this.victoriesSymbol,this.blocksSymbol,this.faztSymbol],this.options.setPlayerFadeInTime,{alpha:0},0),a.to(this.avatar,this.options.setPlayerFadeInTime,{y:this.options.avatarStartY}),a.to(this,this.options.setPlayerFadeOutTime,{alpha:0}),a},PlayerIcon.prototype.appear=function(a){this.avatar.timeline.play();var b=new TimelineMax;return b.to(this,this.options.appearTime,{alpha:1}),a||b.progress(1),b},PlayerIcon.prototype.disappear=function(a){this.avatar.timeline.pause();var b=new TimelineMax;return b.to(this,this.options.appearTime,{alpha:0}),a||b.progress(1),b},PlayerIcon.prototype.setPlayer=function(a,b){this.player=a,this.name.text=a.name,this.points.text=a.points.toString(),this.currentPoints=a.points,this.options.isShowStats&&(this.blocks.text=a.block.toString(),this.fazt.text=a.fazt.toString(),this.victories.text=a.victories.toString()),d.call(this);var c=new TimelineMax({onComplete:g,onCompleteScope:this});return c.to(this.background,this.options.setPlayerFadeOutTime,{colorProps:{changeColor:this.options.playerColor}}),c.to(this.join,this.options.setPlayerFadeOutTime,{alpha:0},0),c.addLabel("fade"),c.to(this.avatar,this.options.setPlayerFadeInTime,{y:this.options.avatarTargetY},"fade"),c.to([this.name,this.points],this.options.setPlayerFadeInTime,{alpha:1},"fade"),this.options.isShowStats&&c.to([this.victories,this.blocks,this.fazt,this.victoriesSymbol,this.blocksSymbol,this.faztSymbol],this.options.setPlayerFadeInTime,{alpha:1},"fade"),b||c.progress(1),c},PlayerIcon.prototype.removePopup=function(a,c){c=_.extend({disappearTime:1},c),void 0===a&&(a=this.popupContainer);var d=new TimelineMax;return a?(d.vars.onComplete=b,d.vars.onCompleteScope=this,d.vars.onCompleteParams=[a],d.to(a,c.disappearTime,{alpha:0}),d):d},PlayerIcon.prototype.popup=function(a){a=_.extend({color:3595850,text:"Ready",textFormat:{font:"22px Montserrat",fill:"#000000",align:"center"},symbol:"",symbolFormat:{font:"25px FontAwesome",fill:"#000000",align:"center"},moveTime:1,stayTime:3,disappearTime:1,padding:10,radius:10,isStay:!1,targetY:-175},a);var b,c=game.add.sprite(-this.options.width/2,-this.options.height/2),d=a.padding;a.symbol&&(b=new Phaser.Text(game,a.padding,a.padding,a.symbol,a.symbolFormat),d+=b.x+b.width,c.addChild(b));var e=new Phaser.Text(game,d,a.padding,a.text,a.textFormat),f=b&&b.height>e.height?b.height:e.height,g=new Phaser.Graphics(game);g.beginFill(a.color),g.drawRoundedRect(0,0,e.x+e.width+a.padding,2*a.padding+f,a.radius),c.addChildAt(g,0),c.addChild(e);var h=this.children.indexOf(this.avatar);this.addChildAt(c,h);var i=new TimelineMax;return i.to(c,a.moveTime,{y:a.targetY}),a.isStay?(this.popupContainer=c,i):(i.add(this.removePopup(c,a),"+="+a.stayTime),i)},PlayerIcon.prototype.tweenColor=function(a){a=_.extend({isReturn:!1,returnTime:3,color:this.options.playerColor},a);var b=new TimelineMax({onStart:k,onStartScope:this});return b.vars.onStartParams=[b],b.to(this.background,this.options.colorTime,{colorProps:{changeColor:a.color}}),a.isReturn&&b.to(this.background,this.options.colorTime,{colorProps:{changeColor:this.options.color}},a.returnTime),b},PlayerIcon.prototype.removeStats=function(){var a=new TimelineMax;return a.to([this.victories,this.blocks,this.fazt,this.victoriesSymbol,this.blocksSymbol,this.faztSymbol],this.options.setPlayerFadeOutTime,{alpha:0},0),a},PlayerIcon.prototype.setAvatarAnimation=function(a,b){this.avatar&&(a?this.avatar.timeline.play():(this.stopAvatarAnimation=!0,b&&this.avatar.timeline.pause()))},PlayerIcon.prototype.setPoints=function(a){var b=new TimelineMax({onUpdate:j,onUpdateScope:this});return b.to(this,this.options.pointsTime,{currentPoints:a}),b},PlayerIcon.prototype.setCards=function(a){var b=new TimelineMax;return b.to(this.cardCountBar.graphicsData[0].shape,1,{width:this.options.width*a}),b},PlayerIcon.prototype.flash=function(a){return this.flashTimeline&&this.flashTimeline.kill(),this.flashTimeline=new TimelineMax({repeat:-1,yoyo:!0}),this.flashTimeline.to(this.cardCountBar,a,{alpha:0,ease:Linear.easeNone}),this.flashTimeline},PlayerIcon.prototype.showIcon=function(a){a=_.extend({symbol:"",symbolFormat:{font:"125px FontAwesome",fill:"#cb1800",align:"center"},time:.75,delayTime:3,y:-20},a);var b=new Phaser.Text(game,0,a.y,a.symbol,a.symbolFormat);b.anchor.set(.5),b.alpha=0,this.addChild(b);var c=new TimelineMax;return c.to(b,a.time,{alpha:1}),c.to(b,a.time,{alpha:0},a.delayTime),c},PlayerIcon.prototype.changeName=function(a){var b=new TimelineLite;return b.to(this.name,.5*this.options.changeNameTime,{alpha:0}),b.addLabel("half"),b.to(this.name,.5*this.options.changeNameTime,{alpha:1},"half"),b.add(function(){this.name.text=a}.bind(this),"half"),b},PlayerIcon.prototype.changeAvatar=function(){this.changeAvatarTimeline&&this.changeAvatarTimeline.kill();var a=new TimelineMax;this.changeAvatarTimeline=a,a.to(this.avatar,.75,{y:this.options.avatarStartY}),a.add(e.bind(this)),a.add(function(){d.call(this),a.to(this.avatar,.75,{y:this.options.avatarTargetY}),a.add(f.bind(this))}.bind(this))}}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.Rain=function(){function a(a){a=_.extend({minX:0,maxX:100,frequencyMin:.01,frequencyMax:.1,angleMin:-1,angleMax:1,widthMin:5,widthMax:10,heightMin:50,heightMax:200,color:13027014,targetY:1e3,speedMin:.6,speedMax:.6},a),this.options=a,Phaser.Sprite.call(this,game,0,0),this.counted=0,this.random=new Phaser.RandomDataGenerator}function b(a){a.destroy()}function c(a){var c=new Phaser.Graphics(game);c.beginFill(a.color),c.drawRect(0,0,a.width,a.height);var d=new Phaser.Sprite(game,a.x,a.y,c.generateTexture());d.angle=a.angle,d.anchor.set(.5);var e=new TimelineMax({onComplete:b,onCompleteScope:this,onCompleteParams:[d]});return e.to(d,a.speed,{y:a.targetY,ease:Linear.easeNone}),d.timeline=e,this.addChild(d),d}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.activate=function(){this.active=!0},a.prototype.postUpdate=function(){this.active&&(this.counted-=.001*game.time.elapsed,this.counted>0||(this.counted=this.random.realInRange(this.options.frequencyMin,this.options.frequencyMax),c.call(this,{color:this.options.color,x:_.random(this.options.minX,this.options.maxX),y:this.options.y,angle:_.random(this.options.angleMin,this.options.angleMax),width:_.random(this.options.widthMin,this.options.widthMax),height:_.random(this.options.heightMin,this.options.heightMax),targetY:this.options.targetY,speed:this.random.realInRange(this.options.speedMin,this.options.speedMax)})))},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.StageBoard=function(){function a(a,c,d){d=_.extend({x:a,y:c,radius:300,color:61455,diffuseColor:0,backgroundAlpha:.3,card:1,cardFormat:{font:"120px Montserrat",fill:"#ffffff",align:"center"},startTime:1,setCardTime:.4,rotateSpeed:-.2,countingTime:10,expandTime:1,disappearTime:1,isLeft:!1},d),this.options=d,this.card=d.card,Phaser.Sprite.call(this,game,a,-500),game.add.existing(this),this.rotateSpeed=d.rotateSpeed/d.radius,this.background=game.add.graphics(),this.background.alpha=this.options.backgroundAlpha,this.background.beginFill(this.options.color),this.background.drawCircle(0,0,this.options.radius),this.background.circle=this.background.graphicsData[0],this.background.colorChange=common.graphicsColorChange(0),this.addChild(this.background),this.foreground=game.add.graphics(),this.foreground.lineStyle(5,this.options.color,1,[10]),this.foreground.colorLineChange=common.graphicsColorChange(0,"lineColor"),this.foreground.drawCircle(0,0,this.options.radius),this.addChild(this.foreground),this.backgroundMask=game.add.graphics(),this.backgroundMask.drawCircle(0,0,this.options.radius),this.backgroundMask.circle=this.backgroundMask.graphicsData[0],this.addChild(this.backgroundMask),this.effectOptions={count:3,backRadius:1.9*d.radius,blurRadius:52},this.animationOptions={delays:[0,0,0],inTimes:[.4,.5,.6],outTimes:[.6,.5,.4],scales:[1,.9,.8]},b.call(this),this.circleScales=[this.text.mask.scale,this.background.scale,this.foreground.scale],this.text.visible=!1,this.appeared=new signals.Signal,this.counted=new signals.Signal,this.expanded=new signals.Signal,this.events.onDestroy.add(this.destroyTween,this)}function b(){this.text=new Phaser.Text(game,0,0,this.card.toString(),this.options.cardFormat),this.text.anchor.set(.5),this.text.mask=this.backgroundMask,this.addChild(this.text)}function c(){this.text.visible=!0}function d(){this.destroyTween(),this.appeared.dispatch()}function e(){}function f(a){a&&a.destroy()}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.destroyTween=function(){this.timeline&&this.timeline.kill()},a.prototype.appear=function(){var a=new TimelineLite({onStart:c.bind(this),onComplete:d,onCompleteScope:this});return a.to(this,this.options.startTime,{y:this.options.y,ease:Power4.easeOut}),a},a.prototype.disappear=function(){var a=new TimelineMax;return a.to(this,this.options.disappearTime,{y:1e3,ease:Power4.easeIn}),a},a.prototype.setCard=function(a,c,d){var g=this.text;if(this.card=a,b.call(this),!d)return void e.call(this,g);var h=parseInt(g.text),i=parseInt(a),j=h>i?1:-1;
(9===h&&0===i||0===h&&9===i)&&(j*=-1);var k=this.options.radius+this.text.height;this.text.y=k*j;var l=new TimelineLite({onComplete:f,onCompleteScope:this,onCompleteParams:[]});return l.to(g,this.options.setCardTime,{onComplete:e,onCompleteScope:this,onCompleteParams:[g],y:-k*j,ease:Linear.noEase},0),l.to(this.text,this.options.setCardTime,{y:0,ease:Linear.noEase},0),l.to(this.background,this.options.setCardTime,{alpha:1,ease:Sine.easeOut},0),l.to(this.background,this.options.setCardTime,{alpha:this.options.backgroundAlpha,ease:Sine.easeIn},this.options.setCardTime),l.to(this.circleScales,this.options.setCardTime,{x:1.4,y:1.4,ease:Sine.easeOut},0),l.to(this.circleScales,this.options.setCardTime,{x:1,y:1,ease:Sine.easeIn},this.options.setCardTime),l},a.prototype.postUpdate=function(){this.foreground.angle+=this.rotateSpeed},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.StagePlayer=function(){function a(){this.textAddPoints.text="+ "+Math.ceil(this.currentAdd),this.textPoints.text=Math.ceil(this.points)}function b(a){a.destroy()}function c(){this.currentColor=this.options.color,this.colorTween.kill()}function d(){TweenMax.killTweensOf(this),TweenMax.killTweensOf(this.textPoints),TweenMax.killTweensOf(this.text),this.flashTimeline&&this.flashTimeline.kill()}StagePlayer=function(a,b,c){c=$.extend({x:a,y:b,disappearY:1e3,nameFormat:{font:"30px Montserrat",align:"center"},pointsFormat:{font:"30px Montserrat",align:"center"},color:16711422,offColor:65793,name:"Angry Llama",points:"0",colorTime:.5,colorFadeInTime:.5,colorFadeOutTime:.5,colorDelayTime:2,addPointsDelayTime:2,addPointsTime:.5,appearTime:.5,disappearTime:.5,lineWidth:100,lineHeight:4},c),this.options=c,c.nameFormat.fill="#"+common.toRgbHex(c.color),c.pointsFormat.fill="#"+common.toRgbHex(c.color),this.points=c.points,Phaser.Sprite.call(this,game,a,this.options.disappearY);var e=40,f=50;this.background=new Phaser.Graphics(game,0,e),this.background.beginFill(this.options.offColor),this.background.drawRoundedRect(-this.options.lineWidth,-this.options.lineHeight,2*this.options.lineWidth,2*this.options.lineHeight,f),this.addChild(this.background),this.foreground=new Phaser.Graphics(game,0,e),this.foreground.beginFill(this.options.color),this.foreground.drawRoundedRect(-this.options.lineWidth,-this.options.lineHeight,2*this.options.lineWidth,2*this.options.lineHeight,f),this.foreground.colorChange=common.graphicsColorChange(0),this.addChild(this.foreground),this.text=new Phaser.Text(game,0,0,c.name,this.options.nameFormat),this.text.colorChange=common.textColorChange(),this.text.anchor.set(.5),this.addChild(this.text),this.textPoints=new Phaser.Text(game,0,80,this.options.points,this.options.pointsFormat),this.textPoints.anchor.set(.5),this.textPoints.colorChange=common.textColorChange(),this.addChild(this.textPoints),this.events.onDestroy.add(d,this),this.currentColor=this.options.color,this.alpha=0},StagePlayer.prototype=Object.create(Phaser.Sprite.prototype),StagePlayer.prototype.constructor=StagePlayer,StagePlayer.prototype.appear=function(){var a=new TimelineMax;return a.to(this,this.options.appearTime,{y:this.options.y,ease:Power4.easeOut}),a},StagePlayer.prototype.disappear=function(){var a=new TimelineMax;return a.to(this,this.options.disappearTime,{y:this.options.disappearY,ease:Power4.easeIn}),a},StagePlayer.prototype.removePlayer=function(){},StagePlayer.prototype.setPlayer=function(a,b,c){return c?void 0:(this.alpha=1,this.text.text=a,void(this.textPoints.text=b))},StagePlayer.prototype.setColor=function(a){return this.colorTween&&this.colorTween.kill(),this.currentColor=a,this.colorTween=new TimelineMax({onComplete:c,onCompleteScope:this}),this.colorTween.to([this.textPoints,this.text,this.textAddPoints],this.options.colorTime,{colorProps:{colorChange:a}}),this.colorTween.addLabel("fadeOut","+="+this.options.colorDelayTime),this.colorTween.to([this.textPoints,this.text,this.textAddPoints],this.options.colorTime,{colorProps:{colorChange:this.options.color}},"fadeOut"),this.colorTween},StagePlayer.prototype.addPoints=function(c,d){if(this.addPointsTimeline&&"fadeOut"!==this.addPointsTimeline.getLabelBefore())return this.targetAdd+=c,this.addPointsTimeline.to(this,this.options.addPointsTime,{points:d,currentAdd:this.targetAdd,onUpdate:a,onUpdateScope:this},"fadeInEnd"),void this.addPointsTimeline.seek("fadeInEnd");this.targetAdd=c,this.currentAdd=this.targetAdd;var e=new Phaser.Text(game,50,80,"+ "+c,_.extend(this.options.pointsFormat,{fill:"#"+common.toRgbHex(this.currentColor)}));return e.anchor.set(.5),e.alpha=0,this.textAddPoints=e,this.addChild(e),this.addPointsTimeline=new TimelineMax,this.addPointsTimeline.to(this,this.options.addPointsTime,{points:d,onUpdate:a,onUpdateScope:this}),this.addPointsTimeline.to(e,this.options.addPointsTime,{alpha:1,x:100},0),this.addPointsTimeline.addLabel("fadeInEnd"),this.addPointsTimeline.addLabel("fadeOut","+="+this.options.addPointsDelayTime),this.addPointsTimeline.to(e,this.options.addPointsTime,{onComplete:b,onCompleteParams:[e],onCompleteScope:this,alpha:0},"fadeOut"),this.addPointsTimeline},StagePlayer.prototype.setCards=function(a){this.foreground.graphicsData[0].points[2]=2*this.options.lineWidth*a},StagePlayer.prototype.flash=function(a,b){this.flashTimeline&&this.flashTimeline.kill(),this.flashTimeline=new TimelineMax({repeat:-1}),this.flashTimeline.to(this.foreground,a,{colorProps:{colorChange:b}}),this.flashTimeline.to(this.foreground,a,{colorProps:{colorChange:this.options.color}})}}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.TextNotification=function(){return TextNotification=function(a,b,c,d,e){e=$.extend({width:c,height:d},e),this.options=e,Phaser.Sprite.call(this,game,a,b)},TextNotification.prototype=Object.create(Phaser.Sprite.prototype),TextNotification.prototype.constructor=TextNotification,TextNotification.prototype.show=function(a,b,c,d){d=_.extend({inTime:.75,outTime:.75,delayTime:7.5,margin:0,textFormat:{font:"bold 79px Montserrat"},symbolFormat:{font:"235px FontAwesome"},symbolColor:16777215,countFormat:{font:"bold 40px Montserrat"},countCircleFormat:{font:"70px FontAwesome"},countColor:16777215,distanceY:400,circleGapY:5,countGapY:-50,countGapX:0,isCircle:!1},d);var e=new TimelineMax;e.addLabel("fade",d.delayTime);for(var f,g=d.distanceY,h=a.length-1;h>=0;h--){var i=a[h],j=_.extend({fill:"#"+common.toRgbHex(i.color),align:"left"},d.textFormat);f=new Phaser.Text(game,0,-g,i.text,j),0!==h&&(g+=f.height+d.margin),f.alpha=0,this.addChild(f),e.to(f,d.inTime,{y:"+="+d.distanceY,alpha:1,ease:Power3.easeOut},0),e.to(f,d.outTime,{y:"+="+d.distanceY,alpha:0,ease:Power3.easeIn},"fade")}var k=_.extend({fill:"#"+common.toRgbHex(d.symbolColor),align:"right"},d.symbolFormat),l=new Phaser.Text(game,this.options.width,d.distanceY+f.height,b,k);if(l.anchor.set(1,1),l.alpha=0,this.addChild(l),e.to(l,d.inTime,{y:"-="+d.distanceY,alpha:1,ease:Power3.easeOut},0),e.to(l,d.outTime,{y:"-="+d.distanceY,alpha:0,ease:Power3.easeIn},"fade"),c){var m=new Phaser.Sprite(game,l.x-l.width+d.countGapX,l.y+d.countGapY);if(this.addChild(m),d.isCircle){var n=_.extend({fill:"#"+common.toRgbHex(d.countColor),align:"center"},d.countCircleFormat),o=new Phaser.Text(game,0,d.circleGapY,"",n);o.anchor.set(.5),m.addChild(o)}var p=_.extend({fill:"#"+common.toRgbHex(d.countColor),align:"center"},d.countFormat),q=new Phaser.Text(game,0,0,c,p);q.anchor.set(.5),m.addChild(q),e.to(m,d.inTime,{y:"-="+d.distanceY,alpha:1,ease:Power3.easeOut},0),e.to(m,d.outTime,{y:"-="+d.distanceY,alpha:0,ease:Power3.easeIn},"fade")}return e},TextNotification}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.TimerBall=function(){function a(a,b,c,d){d=_.extend({color:0,format:{font:"50px Arial",fill:"#eeeeee",align:"center"},text:""},d),d.card=_.extend({time:.25,delayTime:.3,complete:this.beginCounting.bind(this)},d.card),d.counting=_.extend({time:4,complete:this.expand.bind(this),scale:0,delayTime:0},d.counting),d.expand=_.extend({time:1,scale:10,isBreak:!0,breakScale:2.5,breakTime:1,breakTimeOut:.1,colorTime:.5,delayTime:0,complete:this.deflate.bind(this)},d.expand),d.deflate=_.extend({time:1,scale:1,delayTime:.3,complete:this.beginCounting.bind(this)},d),this.options=d,Phaser.Sprite.call(this,game,a,b),game.add.existing(this),this.background=game.add.graphics(),this.background.beginFill(d.color),this.background.drawCircle(0,0,c),this.addChild(this.background),this.text=new Phaser.Text(game,0,0,d.text,d.format),this.text.anchor.set(.5),this.addChild(this.text)}function b(){var a=this.options.deflate,b=new TimelineLite({});return b.addLabel("deflate","+=0.1"),b.to(this.scale,a.time,{x:a.scale,y:a.scale,ease:Back.easeOut},"deflate"),b.add(function(){a.complete&&a.complete()},"+="+a.delayTime),b.addLabel("deflateEnded"),b}function c(){var a=this.options.counting,b=new TimelineLite({});return console.log("starting"),b.addLabel("counting"),b.to(this,a.time,{colorProps:{backgroundColor:this.options.color}},"counting"),b.to(this.scale,a.time,{x:a.scale,y:a.scale,ease:Power3.easeIn},"counting"),b.add(function(){a.complete&&a.complete()},"+="+a.delayTime),b.addLabel("countingEnded"),b}function d(){var a=this.options.expand,b=new TimelineLite({});return b.addLabel("expand"),b.to(this,a.colorTime,{colorProps:{backgroundColor:this.options.color}},"expand"),b.to(this.scale,a.breakTime,{x:a.breakScale,y:a.breakScale,ease:Elastic.easeOut},"expand"),b.addLabel("expandBreak","-="+a.breakTimeOut),b.add(function(){a.breakCallback&&a.breakCallback()},"expandBreak"),b.to(this.scale,a.time,{x:a.scale,y:a.scale},"expandBreak"),b.add(function(){a.complete&&a.complete()},"+="+a.delayTime),b.addLabel("expandEnded"),b}function e(a){var b=this.options.card,c=new TimelineLite({});return c.addLabel("card"),c.fromTo(this.scale,b.time,{x:.5,y:.5},{x:1,y:1,ease:Elastic.easeOut},"card"),c.to(this,b.time/2,{colorProps:{backgroundColor:a}},"card"),c.addLabel("cardHalf"),c.add(function(){b.complete&&b.complete()},"cardHalf+="+b.delayTime),c.addLabel("cardEnded"),c}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,a.prototype.setCard=function(a){this.options.card;return this.playTimeline(e.call(this,a))},a.prototype.backgroundColor=function(a){return void 0!==a&&(this.background.graphicsData[0].fillColor=common.getRgb(a)),this.background.graphicsData[0].fillColor},a.prototype.beginCounting=function(){return this.playTimeline(c.call(this))},a.prototype.expand=function(a,b){return this.options.expand.complete=a,this.options.expand.breakCallback=b,this.playTimeline(d.call(this))},a.prototype.deflate=function(){return this.playTimeline(b.call(this))},a.prototype.playTimeline=function(a){return this.currentTimeline&&this.currentTimeline.kill(),a?(this.currentTimeline=a,a):void 0},a}(),com.speez.components=_.extend({},com.speez.components),com.speez.components.TimerLines=function(){function a(c){c=_.extend({time:10,width:40,height:100,color:12961253,isLeft:!1,startDelay:2,noMovesTime:1,disappearTime:1},c),this.options=c,Phaser.Sprite.call(this,game,0,0),this.state="",this.leftLine=new Phaser.Graphics(game,0,0),this.leftLine.changeColor=common.graphicsColorChange(0),this.leftLine.beginFill(this.options.color),this.leftLine.drawRect(0,0,this.options.width,this.options.height),this.addChild(this.leftLine),this.rightLine=new Phaser.Graphics(game,0,0),this.rightLine.changeColor=common.graphicsColorChange(0),this.rightLine.beginFill(this.options.color),this.rightLine.drawRect(0,0,this.options.width,this.options.height),this.addChild(this.rightLine),this.area=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),this.area.attach(this.leftLine,{width:c.width,height:c.height,alignHorizontal:Layout.ALIGN_LEFT}),this.area.attach(this.rightLine,{width:c.width,height:c.height,alignHorizontal:Layout.ALIGN_RIGHT}),this.state=a.STATE_INIT,this.countTimeline=f.call(this),this.countTimeline.pause(),this.countTimeline.progress(1),this.events.onDestroy.add(b,this)}function b(){this.countTimeline.kill()}function c(){this.state=a.STATE_PLAY,this.count()}function d(b){(this.state===a.STATE_PLAY||b)&&this.options.countComplete&&this.options.countComplete()}function e(){this.setCardTimeline.kill(),this.setCardTimeline=null}function f(){var a=new TimelineMax({onComplete:d,onCompleteScope:this});return a.to(this.leftLine.graphicsData[0].shape,this.options.time,{height:this.options.height,ease:Linear.easeNone},0),a.to(this.rightLine.graphicsData[0].shape,this.options.time,{height:this.options.height,ease:Linear.easeNone},0),a}return a.prototype=Object.create(Phaser.Sprite.prototype),a.prototype.constructor=a,Object.defineProperty(a,"STATE_INIT",{value:"init"}),Object.defineProperty(a,"STATE_PLAY",{value:"play"}),Object.defineProperty(a,"STATE_FINISH",{value:"finish"}),a.prototype.appear=function(){this.countTimeline.pause();var a=new TimelineMax;return a.to(this.countTimeline,1,{progress:0},0),a.add(c.bind(this),"+="+this.options.startDelay),a},a.prototype.disappear=function(){this.countTimeline.pause(),this.state=a.STATE_FINISH;var b=new TimelineMax({});return b.to(this.countTimeline,this.options.disappearTime,{progress:1}),b},a.prototype.count=function(){return this.countTimeline.play(),this.countTimeline},a.prototype.setCard=function(a){this.countTimeline.pause(),this.setCardTimeline&&this.setCardTimeline.kill();var b=new TimelineMax({onComplete:e,onCompleteScope:this});return b.to(this.countTimeline,1,{progress:Math.max(0,this.countTimeline.progress()-.5)},0),b.to([this.leftLine,this.rightLine],1,{colorProps:{changeColor:a}},0),b.to([this.leftLine,this.rightLine],1,{colorProps:{changeColor:this.options.color}},1),b.add(this.count.bind(this),2),this.setCardTimeline=b,b},a.prototype.noMoves=function(){this.countTimeline.pause(),this.state=a.STATE_FINISH;var b=new TimelineMax({onComplete:d,onCompleteScope:this,onCompleteParams:[!0]});return b.to(this.countTimeline,this.options.noMovesTime,{progress:1}),b},a}();var moduel=function(){function a(b){b=_.extend({width:600,height:800,minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE,isDebug:!1},b),this.options=b,this.originalWidth=b.width,this.originalHeight=b.height,this.currentWidth=b.width,this.currentHeight=b.height,this.maxScaleX=b.maxHeight/b.width,this.maxScaleY=b.maxHeight/b.height,this.minScaleX=b.minWidth/b.width,this.minScaleY=b.minHeight/b.height,this.scaleX=1,this.scaleY=1,this.enable=!0,this.init&&this.init(),this.pinArray=[],this.resized=new signals.Signal,a.instance=this}function b(b){var c=b.layout;switch(b.type){case a.PIN_LEFT_TOP:break;case a.PIN_TOP:b.obj.x+=.5*c.deltaWidth;break;case a.PIN_RIGHT_TOP:b.obj.x+=c.deltaWidth;break;case a.PIN_RIGHT:b.obj.x+=c.deltaWidth;break;case a.PIN_RIGHT_BOTTOM:b.obj.x+=c.deltaWidth,b.obj.y+=c.deltaHeight;break;case a.PIN_BOTTOM:b.obj.x+=.5*c.deltaWidth,b.obj.y+=c.deltaHeight;break;case a.PIN_LEFT_BOTTOM:b.obj.y+=c.deltaHeight;break;case a.PIN_LEFT:b.obj.y+=.5*c.deltaHeight;break;case a.PIN_CENTER:b.obj.x+=.5*c.deltaWidth,b.obj.y+=.5*c.deltaHeight}}function c(a,b,c){this.layout=a,this.obj=b,this.type=c}function d(b,c,d,e,f){f=_.extend({width:d,height:e,x:b,y:c,layout:a.instance,isDebug:!1},f),this.options=f,this.attachArray=[],this.originalWidth=f.width,this.originalHeight=f.height,this.layout=f.layout,this.layout.resized.add(this.resize.bind(this)),this.init&&this.init(),this.x=f.x,this.y=f.y,this.resized=new signals.Signal,this.resize()}return Object.defineProperty(a,"PIN_LEFT_TOP",{value:"leftTop"}),Object.defineProperty(a,"PIN_LEFT_BOTTOM",{value:"leftBottim"}),Object.defineProperty(a,"PIN_LEFT",{value:"left"}),Object.defineProperty(a,"PIN_RIGHT_TOP",{value:"rightTop"}),Object.defineProperty(a,"PIN_RIGHT_BOTTOM",{value:"rightBottom"}),Object.defineProperty(a,"PIN_RIGHT",{value:"right"}),Object.defineProperty(a,"PIN_TOP",{value:"top"}),Object.defineProperty(a,"PIN_BOTTOM",{value:"bottom"}),Object.defineProperty(a,"PIN_CENTER",{value:"center"}),Object.defineProperty(a,"NONE",{value:"none"}),Object.defineProperty(a,"PROPORTIONAL_INSIDE",{value:"proportionalInside"}),Object.defineProperty(a,"PROPORTIONAL_OUTSIDE",{value:"proportionalOutside"}),Object.defineProperty(a,"STRETCH",{value:"stretch"}),Object.defineProperty(a,"STRETCH_WIDTH",{value:"stretchWidth"}),Object.defineProperty(a,"STRETCH_HEIGHT",{value:"stretchHeight"}),Object.defineProperty(a,"ALIGN_LEFT",{value:"left"}),Object.defineProperty(a,"ALIGN_RIGHT",{value:"right"}),Object.defineProperty(a,"ALIGN_CENTER",{value:"center"}),Object.defineProperty(a,"ALIGN_TOP",{value:"top"}),Object.defineProperty(a,"ALIGN_BOTTOM",{value:"bottom"}),Object.defineProperty(a,"ALIGN_MIDDLE",{value:"middle"}),Object.defineProperty(a,"STATE_ADDED",{value:"added"}),Object.defineProperty(a,"STATE_UPDATE",{value:"update"}),a.prototype.resize=function(a,c){this.enable&&(this.scaleX=a/this.originalWidth,this.scaleX=Math.min(this.maxScaleX,this.scaleX),this.scaleX=Math.max(this.minScaleX,this.scaleX),this.scaleY=c/this.originalHeight,this.scaleY=Math.min(this.maxScaleY,this.scaleY),this.scaleY=Math.max(this.minScaleY,this.scaleY),this.minScale=Math.min(this.scaleX,this.scaleY),this.maxScale=Math.max(this.scaleX,this.scaleY),this.scaling&&this.scaling(this.scaleX,this.scaleY),this.deltaWidth=a-this.currentWidth,this.deltaHeight=c-this.currentHeight,_.each(this.pinArray,b),this.currentWidth=a,this.currentHeight=c,this.resized.dispatch(this,a,c))},a.prototype.pin=function(a,b){var d=new c(this,a,b);this.pinArray.push(d),this.pinAdded&&this.pinAdded(a,d)},a.prototype.unpin=function(a){this.pinArray=_.reject(this.pinArray,function(b){return b.obj===a}),this.pinRemoved&&this.pinRemoved(a)},d.prototype.attach=function(b,c){if(!this.getAttached(b)){c=_.extend({width:b.width-20,height:b.height-20,alignHorizontal:a.ALIGN_CENTER,alignVertical:a.ALIGN_MIDDLE,mode:a.PROPORTIONAL_INSIDE},c);var d={obj:b,options:c,state:a.STATE_ADDED};this.attachArray.push(d),this.scaleAttached(d),d.state=a.STATE_UPDATE,this.onAttached&&this.onAttached(b)}},d.prototype.unattach=function(a){return this.getAttached(a)?(this.attachArray=_.reject(this.attachArray,function(){return a===a}),this.onUnattached&&this.onUnattached(a),!0):!1},d.prototype.getAttached=function(a){return _.findWhere(this.attachArray,{obj:a})},d.prototype.resize=function(){this.currentX=this.options.x*this.layout.scaleX,this.currentY=this.options.y*this.layout.scaleY,this.currentWidth=this.options.width*this.layout.scaleX,this.currentHeight=this.options.height*this.layout.scaleY,_.each(this.attachArray,this.scaleAttached.bind(this)),this.resized.dispatch(this.currentWidth,this.currentHeight)},d.prototype.scaleAttached=function(b){var c;switch(b.options.mode){case a.PROPORTIONAL_INSIDE:c=this.proportionalInside(b);break;case a.PROPORTIONAL_OUTSIDE:c=this.proportionalOutside(b);break;case a.STRETCH:c=this.stretch(b);break;case a.STRETCH_WIDTH:c=this.stretchWidth(b);break;case a.STRETCH_HEIGHT:c=this.stretchHeight(b);break;case a.NONE:c=this.none(b);break;default:return}this.setScale(b,c)},d.prototype.proportionalOutside=function(a){var b,c={},d=this.currentWidth/a.options.width,e=this.currentHeight/a.options.height;return e>d?(b=e,c.x=.5*this.currentWidth-a.options.width*b*.5,c.y=this.currentY):(b=d,c.x=this.currentX,c.y=.5*this.currentHeight-a.options.height*b*.5),c.scaleX=b,c.scaleY=b,c},d.prototype.proportionalInside=function(a){var b,c={},d=this.currentWidth/a.options.width,e=this.currentHeight/a.options.height;return d>e?(b=e,c.x=this.alignHorizontal(a,b),c.y=this.currentY):(b=d,c.x=this.currentX,c.y=this.alignVertical(a,b)),c.scaleX=b,c.scaleY=b,c},d.prototype.stretch=function(a){return{scaleX:this.currentWidth/a.options.width,scaleY:this.currentHeight/a.options.height,x:this.currentX,y:this.currentY}},d.prototype.stretchWidth=function(a){return{scaleX:this.currentWidth/a.options.width,x:this.currentX,y:this.alignVertical(a,1)}},d.prototype.stretchHeight=function(a){return{scaleY:this.currentHeight/a.options.height,x:this.alignHorizontal(a,1),y:this.currentY}},d.prototype.none=function(a){return{x:this.alignHorizontal(a,1),y:this.alignVertical(a,1)}},d.prototype.alignHorizontal=function(b,c){switch(b.options.alignHorizontal){case a.ALIGN_LEFT:return this.currentX;case a.ALIGN_CENTER:return this.currentX+.5*this.currentWidth-b.options.width*c*.5;case a.ALIGN_RIGHT:return this.currentX+this.currentWidth-b.options.width*c}},d.prototype.alignVertical=function(b,c){switch(b.options.alignVertical){case a.ALIGN_TOP:return this.currentY;case a.ALIGN_MIDDLE:return this.currentY+.5*this.currentHeight-b.options.height*c*.5;case a.ALIGN_BOTTOM:return this.currentY+this.currentHeight-b.options.height*c}},{Layout:a,LayoutArea:d,Pin:c}}(window);com=_.extend(moduel,com);var Layout=moduel.Layout,LayoutArea=moduel.LayoutArea;!function(){var a=com.LayoutArea,b=com.Layout;b.prototype=_.extend(Object.create(Phaser.Group.prototype),b.prototype),b.prototype.constructor=com.LayoutArea,b.prototype.init=function(){if(Phaser.Group.call(this,this.options.game),this.options.game.add.existing(this),this.options.isDebug){this.graphics=this.options.game.add.graphics(),this.graphics.beginFill(13369344),this.graphics.drawRect(0,0,this.options.width,this.options.height);var a=this.originalWidth,b=this.originalHeight,c=a>b?.2*b:.2*a;this.graphics.drawRect(0,0,a,b),this.graphics.beginFill(170),this.graphics.drawRect(0,0,c,c),this.graphics.drawRect(a-c,0,c,c),this.graphics.drawRect(0,b-c,c,c),this.graphics.drawRect(a-c,b-c,c,c),this.graphics.visible=this.options.isDebug,this.add(this.graphics)}},b.prototype.scaling=function(a,b){this.scale.set(a,b)},b.prototype.pinAdded=function(a){a.events&&a.events.onDestroy&&(a.layoutDestroy=function(){layout.unpin(a)},a.events.onDestroy.add(a.layoutDestroy))},b.prototype.pinRemoved=function(a){a.events&&a.events.onDestroy&&a.events.onDestroy.remove(a.layoutDestroy)},a.prototype=_.extend(Object.create(Phaser.Sprite.prototype),a.prototype),a.prototype.constructor=com.LayoutArea,a.prototype.init=function(){if(this.game=this.layout.game,Phaser.Sprite.call(this,this.game),this.layout.add(this),this.changesArray=[],this.preUpdate=this.performChanges,this.options.isDebug){this.graphics=this.game.add.graphics(),this.graphics.beginFill(52224),this.graphics.drawRect(0,0,this.options.width,this.options.height),this.debugBox=this.graphics.graphicsData[0];var a=this.options.width,b=this.options.height,c=a>b?.2*b:.2*a;this.graphics.drawRect(0,0,a,b),this.graphics.beginFill(170),this.graphics.drawRect(0,0,c,c),this.graphics.drawRect(a-c,0,c,c),this.graphics.drawRect(0,b-c,c,c),this.graphics.drawRect(a-c,b-c,c,c),this.addChild(this.graphics),this.graphics.visible=this.options.isDebug}},a.prototype.onAttached=function(a){a.events&&a.events.onDestroy&&(a.layoutAreaDestroy=function(){this.unattach(a)}.bind(this),a.events.onDestroy.add(a.layoutAreaDestroy))},a.prototype.onUnattached=function(a){a.events&&a.events.onDestroy&&a.events.onDestroy.remove(a.layoutAreaDestroy)},a.prototype.performChanges=function(){return this.isUpdate>0?void this.isUpdate--:void(0===this.isUpdate&&(_.each(this.changesArray,this.performChangeAttach.bind(this)),this.changesArray=[],this.isUpdate=-1))},a.prototype.performChangeAttach=function(a){var b=this.getAttached(a.obj);b&&(a.obj.x=a.data.x,a.obj.y=a.data.y,a.obj.parent!==game.world&&(a.obj.x-=a.obj.parent.x,a.obj.y-=a.obj.parent.y),a.obj.scale.set(a.data.scaleX?a.data.scaleX:a.obj.scale.x,a.data.scaleY?a.data.scaleY:a.obj.scale.y),a.options.onResize&&a.options.onResize.call(this,a))},a.prototype.setScale=function(a,c){this.isUpdate=a.state===b.STATE_UPDATE?0:0,this.changesArray.push(_.extend(a,{data:c}))},a.prototype.onResize=function(a){this.scale&&this.scale.set(a)}}();var Network=function(){function a(a){this.options=_.extend({address:config.address},a),socket=io.connect(this.options.address),socket.on("disconnect",c),socket.on("connect",b),socket.on("connectError",d),socket.on("connectTimeout",d),socket.off=socket.removeListener}function b(){console.log("Connected")}function c(){player=null,stage=null,console.log("Disconnected"),game.state.start("main")}function d(){}return a}(),bootState=function(){function a(){console.log("Trying to connect to "+config.address),network=new Network}function b(){game.scale.scaleMode=Phaser.ScaleManager.RESIZE,game.scale.pageAlignHorizontally=!0,game.scale.pageAlignVeritcally=!0,game.scale.refresh(),game.scale.setResizeCallback(c),layout=new com.Layout({game:game,width:originalWidth,height:originalHeight}),c(game.scale,game.world.getBounds(),!0)}function c(a,b,e,f){if(Layout.instance){if(Layout.instance.resize(a.width,a.height),f)return;clearTimeout(d),setTimeout(function(){c(a,b,e,!0)},500)}}var d=0;return{preload:function(){game.load.image("bblogo","images/bros_logo.png"),game.load.image("logo","images/speez_logo.png"),game.load.image("logoGray","images/speez_logo_gray.png"),game.load.image("logoO","images/speez_logo_o.png"),game.load.image("beta","images/beta.png");var a=common.addZeroes(_.random(1,avatarNames.length),2);game.load.image("preloadAvatar","images/avatar_"+a+"_head.png")},create:function(){game.stage.disableVisibilityChange=!0,b(),config.isUnderConstruction?game.state.start("mail"):(a(),game.state.start("preload"))},render:function(){}}}(),lobbyState=function(){function a(){game.stage.backgroundColor=14869218;var a=70;if(t=new com.speez.components.Header(originalWidth,a,{alpha:0}),config.isPlayer){var c=game.add.text(30,.5*a,"",{font:"20px FontAwesome",fill:"#000000",align:"center"});c.anchor.set(.5),c.inputEnabled=!0,c.events.onInputDown.add(h),t.addLeft(c)}u=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),x=game.add.sprite(),w=game.add.sprite(),u.attach(w,{width:originalWidth,height:originalHeight}),u.attach(x,{width:originalWidth,height:originalHeight,alignVertical:Layout.ALIGN_BOTTOM}),v=game.add.group(),z=[],v.x=originalWidthCenter,v.y=210,w.addChild(v);var g=_.keys(stage.players);if(0===g.length)z.push(f()),e();else{g=_.sortBy(g,function(a){return stage.players[a].icon});for(var i=0;i<g.length;i++){var j=stage.players[g[i]],k=f();k.setPlayer(j,!1),z.push(k),j.icon=z.indexOf(k)}e().progress(1),z.length<4&&(z.push(f()),e())}var l={font:"22px Montserrat",fill:"#000000",align:"center"};y=game.add.text(originalWidthCenter,originalHeight-30,"GAME NUMBER",l),y.anchor.set(.5),x.addChild(y),blockNumber=new com.speez.components.BlockNumber(originalWidthCenter-130,originalHeight-126,260,70,stage.id,{format:{font:"52px Montserrat",fill:"#ffffff",align:"center"},margin:10}),x.addChild(blockNumber),b(),d(1===z.length).progress(1),common.addLogo("logo",u),common.addLogo("beta",u)}function b(){A=game.add.sprite(originalWidthCenter,originalHeightCenter),w.addChild(A);var a=game.add.sprite(-150,0,"lobbyDescription");a.anchor.set(.5),a.scale.set(.9),A.addChild(a);var b=-100,c=game.add.text(120,b,"JOIN THE GAME\nON YOUR SMARTPHONE",{font:"20px Montserrat",fill:0,align:"center"}),d=game.add.text(120,b+c.height,"AND ENTER THIS NUMBER",{font:"bold 20px Montserrat",fill:0,align:"center"});c.anchor.set(.5,0),d.anchor.set(.5,0),A.addChild(c),A.addChild(d);var e=new com.speez.components.BlockNumber(c.x-105,0,210,60,stage.id,{format:{font:"52px Montserrat",fill:"#ffffff",align:"center"},margin:10});A.addChild(e);var f=game.add.text(c.x,80,"GAME NUMBER",{font:"20px Montserrat",fill:0,align:"center"});f.anchor.set(.5),A.addChild(f)}function c(){var a=game.add.text(originalWidthCenter,143,"PAUZE",{font:"bold 50px FontAwesome",fill:"#ffffff",align:"center"});a.anchor.set(.5),btnContinue=new MenuButton(originalWidthCenter,313,324,96,{color:39935,textColor:1973790,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"CONTINUE",callback:i}),btnExit=new MenuButton(originalWidthCenter,453,324,85,{color:1973790,textColor:16777215,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"END GAME",callback:j}),pause=new com.speez.components.PauseScreen(originalWidth,originalHeight),game.add.existing(pause),pause.container.addChild(a),pause.container.addChild(btnExit),pause.container.addChild(btnContinue)}function d(a){var b=new TimelineMax;return b.to(A,1,{alpha:a?1:0}),b.to([v,blockNumber,y],1,{alpha:a?0:1},0),b}function e(){for(var a=200,b=new TimelineMax,c=0;c<z.length;c++){var d=z[c],e=.5*-a*(z.length-1)+c*a;b.to(d,1,{x:e},0)}return b}function f(){var a=new PlayerIcon(0,0,155,80,{readyColor:3595850}),b=z[g()];return b&&(a.x=b.x,a.y=b.y),v.addAt(a,0),a}function g(){return z.length-1}function h(){c()}function i(){pause.destroy()}function j(){confirm("Are you sure?")&&(_.each(pause.container.children,function(a){a.setEnable&&a.setEnable(!1)}),socket.emit("speed:stage:stageLeave",s))}function k(b){stage={id:b.id,players:[]},a()}function l(){a()}function m(a){console.log("handleJoin:",a);var b=a;stage.players[a.id]=b,b.victories=0,b.icon=g(),B=z[b.icon].setPlayer(b,!0),1===z.length&&d(!1),z.length<4&&(z.push(f()),B.add(e()))}function n(a){console.log("handleLeave:",a);for(var b=stage.players[a.id],c=z[b.icon],g=b.icon+1;g<z.length;g++){var h=z[g];h.player&&h.player.icon--}z.splice(b.icon,1);var i=c.removePlayer();i.add(c.removePopup(),0),1===z.length?i.add(d(!0)):z[z.length-1].player&&z.push(f()),i.add(e()),delete stage.players[a.id]}function o(a){console.log("handleReady:",a);var b=stage.players[a.id];if(b){b.isReady=a.isReady;var c=z[b.icon];b.isReady?(c.popup({color:3595850,text:"Ready",symbol:"",moveTime:1,isStay:!0}),c.tweenColor({color:3595850})):(c.removePopup(),c.tweenColor())}}function p(a){console.log("handleLoad:",a),stage.game=a,b&&b.kill();var b=new TimelineMax({onComplete:function(){game.state.start("stage")}}),c=z[z.length-1];c.player||(z.splice(z.length-1,1),b.to(c,1,{alpha:0})),b.add(function(){_.invoke(z,"setAvatarAnimation",!1)}),b.add(e(),0),b.add(_.invoke(z,"removePopup"),0),b.add(_.invoke(z,"removeStats"),0),b.addLabel("start"),b.add(_.invoke(z,"tweenColor",{color:16777215}),"start"),b.to(v,2,{y:originalHeight-60,ease:Sine.easeInOut},"start"),b.to([blockNumber,y],2,{y:"+=250",alpha:0,ease:Sine.easeIn},"start"),b.add(common.tweenStageColor(1973790,null,1))}function q(a){var b=stage.players[a.playerId];b.name=a.name;var c=z[b.icon];c.changeName(a.name)}function r(a){console.log("handleAvatar:",a);var b=stage.players[a.playerId],c=z[b.icon];b.avatar=a.avatar,c.changeAvatar(b.avatar)}function s(a){console.log("handleStageLeave:",a),stage=null,game.state.start("main")}var t,u,v,w,x,y,z,A,B;return{preload:function(){},create:function(){common.flipOrientation("landscape"),layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),Layout.instance.resize(game.width,game.height),socket.on("speed:stage:join",m),socket.on("speed:stage:leave",n),socket.on("speed:stage:ready",o),socket.on("speed:stage:load",p),socket.on("speed:stage:name",q),socket.on("speed:stage:avatar",r),stage?socket.emit("speed:stage:nextLobby",null,l):socket.emit("speed:create",null,k)},update:function(){},shutdown:function(){socket.off("speed:stage:join",m),socket.off("speed:stage:leave",n),socket.off("speed:stage:ready",o),socket.off("speed:stage:load",p),socket.off("speed:stage:name",q),socket.off("speed:stage:avatar",r)}}}(),lobbyPlayerState=function(){function a(){s=new com.LayoutArea(0,0,originalWidth,originalHeight),container=game.add.sprite(),s.attach(container,{width:originalWidth,height:originalHeight,onResize:b}),game.stage.backgroundColor=14869218,r=new com.speez.components.BlockNumber(originalWidthCenter-235,120,470,125,player.stageId),game.add.existing(r),container.addChild(r);var a={font:"27px Montserrat",fill:"#000000",align:"center"};v=game.add.text(originalWidthCenter,80,"GAME NUMBER",a),v.anchor.set(.5),container.addChild(v);var c={color:3595850,textColor:0,colorOver:2530868,textColorOver:0,colorDown:3595850,format:{font:"bold 44px Montserrat, FontAwesome",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:0,radius:10};
u=new MenuButton(0,814,476,154,_.extend({callback:h,text:"I'M READY"},c));var d={font:"27px Montserrat",fill:"#000000",align:"center"};w=game.add.text(0,540,"YOUR NAME IS",d),w.anchor.set(.5),t=game.add.group(),t.add(u),t.add(w),t.x=originalWidthCenter,t.y=0,container.addChild(t),$("<form>").submit(function(a){a.preventDefault()}).appendTo("body"),$("<style>").appendTo("form").text("input::-webkit-input-placeholder { font-size: 60 }"),$('<input id="tbxChangeName" type="text">').appendTo("form").addClass("tbxChangeName").css({"background-color":"transparent","font-family":"Montserrat, FontAwesome"}).attr("placeholder","ENTER NAME").focusout(e).focusin(f).change(g).keyup(g).val(player.name),q=new com.speez.components.AvatarPicker(originalWidthCenter,400,{avatar:player.avatar,avatarNames:avatarNames}),q.changed.add(j),container.addChild(q);var k=100;x=new com.speez.components.Header(originalWidth,k,{alpha:0});var l=game.add.text(50,.5*k,"",{font:"65px FontAwesome",fill:"#000000",align:"center"});l.anchor.set(.5),l.inputEnabled=!0,l.events.onInputDown.add(i),x.addLeft(l)}function b(){var a=486*Layout.instance.minScale,b=128*Layout.instance.minScale,c=container.x+(originalWidthCenter-5)*Layout.instance.minScale-.5*a,d=container.y+635*Layout.instance.minScale-.5*b;$("#tbxChangeName").css({left:c+"px",top:d+"px",width:a*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px",height:b*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px","border-width":5*Layout.instance.minScale+"px","font-size":60*Layout.instance.minScale+"px","line-height":80*Layout.instance.minScale+"px"}),$("form style").text("input::-webkit-input-placeholder {font-size:"+60*Layout.instance.minScale+"px}\n")}function c(a){$("#tbxChangeName").prop("disabled",!a),t.callAll("setEnable",null,a)}function d(){$("form").remove()}function e(){var a=$("#tbxChangeName").val().substring(0,7);$("#tbxChangeName").val(a),a&&player.name!==a?(socket.emit("speed:player:name",{name:a},m),c(!1)):($("#tbxChangeName").val(player.name),u.setEnable(!0)),Layout.instance.enable=!0,_.delay(function(){Layout.instance.resize(game.width,game.height)},2e3)}function f(){Layout.instance.enable=!1,u.setEnable(!1),$("#tbxChangeName").val("")}function g(a){if(13===a.keyCode)return void $("#tbxChangeName").blur();var b=$("#tbxChangeName").val().substring(0,7);$("#tbxChangeName").val(b)}function h(){p=!p,$("#tbxChangeName").prop("disabled",p),u.setText(p?"":"I'M READY"),$("#tbxChangeName").prop("disabled",p),q.setEnable(!p),common.tweenStageColor(p?3595850:14869218,function(){socket.emit("speed:player:ready",{isReady:p},n)},1)}function i(){c(!1),socket.emit("speed:player:leave",k)}function j(a){player.avatar=a,c(!1),socket.emit("speed:player:avatar",{avatar:a},o)}function k(a){console.log("handleLeave:",a),game.state.start("main")}function l(a){console.log("handleLoad:",a),c(!1),player.game=a,player.game.cardTotal=player.game.cardCount,_gaq.push(["_trackEvent","speez","player",player.avatar]),game.state.start("player")}function m(a){console.log("handleName:",a),player.name=a.name,c(!0)}function n(a){console.log("handleName:",a)}function o(a){console.log("handleAvatar:",a),c(!0)}var p,q,r,s,t,u,v,w,x;return{preload:function(){common.flipOrientation("portrait")},create:function(){layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),p=!1,a(),common.addLogo("beta",s),socket.on("speed:player:load",l),socket.on("speed:player:leave",k),Layout.instance.resize(game.width,game.height),_.delay(function(){Layout.instance.resize(game.width,game.height)},1e3)},update:function(){},shutdown:function(){socket.off("speed:player:leave",k),socket.off("speed:player:load",l),d()}}}(),mailState=function(){function a(){}function b(){common.open("https://www.youtube.com/watch?v=meak65zqfGE")}function c(){common.open("https://www.facebook.com/Speez.co")}function d(){_.delay(function(){Layout.instance.enable=!0,Layout.instance.resize(game.width,game.height)},2e3),this.tbxMail.removeClass("focus").attr("placeholder",this.emailPlaceholderText)}function e(){Layout.instance.enable=!1,this.tbxMail.addClass("focus").removeClass("error").attr("placeholder",this.emailPlaceholderFocusText)}function f(){}function g(a){if(13===a.keyCode){a.preventDefault(),this.tbxMail.blur();var b=this.tbxMail.val().toLowerCase();if(!b)return;return/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(b)?(this.hideMail(),this.showThinking(),void $.ajax({type:"POST",url:"/mail",data:{mail:b},success:h.bind(this),error:i.bind(this),complete:this.hideThinking.bind(this)})):void this.tbxMail.addClass("error").val("").attr("placeholder","INVALID EMAIL ADDRESS")}}function h(a){var b="Your address is saved.\nYou will receive a notification\nwhen the game is ready!";a.isRegistered&&(b="Your address was already saved.\nWe are working really hard\nso you will enjoy Speez very soon!"),this.savedText=game.add.text(originalWidthCenter,originalHeightCenter,b,{font:"bold 35px Montserrat",fill:"#000000",align:"center"}),this.savedText.anchor.set(.5),this.container.addChild(this.savedText)}function i(a){var b=a.responseJSON;this.tbxMail.addClass("error").val("").attr("placeholder",b[0].msg),this.showMail()}function j(){var a=466*Layout.instance.minScale,b=144*Layout.instance.minScale,c=this.container.x+(originalWidthCenter-5)*Layout.instance.minScale-.5*a,d=this.container.y+530*Layout.instance.minScale-.5*b;this.tbxMail.css({left:c+"px",top:d+"px",width:a*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px",height:b*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px","border-width":5*Layout.instance.minScale+"px","font-size":40*Layout.instance.minScale+"px","line-height":80*Layout.instance.minScale+"px"}),$("form style").text("input::-webkit-input-placeholder {font-size:"+35*Layout.instance.minScale+"px}\ninput.focus::-webkit-input-placeholder {font-size:"+35*Layout.instance.minScale+"px}\ninput.error::-webkit-input-placeholder {font-size:"+35*Layout.instance.minScale+"px}")}return a.prototype.preload=function(){common.flipOrientation("portrait"),layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1});for(var a=0;a<avatarNames.length;a++){var b=common.addZeroes(a+1,2);game.load.image(avatarNames[a]+"_head","images/avatar_"+b+"_head.png")}},a.prototype.create=function(){this.drawGui(),Layout.instance.resize(game.width,game.height)},a.prototype.drawGui=function(){this.container=game.add.sprite(),this.area=new com.LayoutArea(0,0,originalWidth,originalHeight),this.area.attach(this.container,{width:originalWidth,height:originalHeight,onResize:j.bind(this)}),game.stage.backgroundColor=14869218,this.updateText=game.add.text(originalWidthCenter,originalHeightCenter),this.updateText.anchor.set(.5),this.container.addChild(this.updateText),this.logo=game.add.sprite(originalWidthCenter,125,"logo"),this.logo.anchor.set(.5),this.container.addChild(this.logo),this.logoO=game.add.sprite(originalWidthCenter,310,"logoO"),this.logoO.anchor.set(.5),this.container.addChild(this.logoO),this.avatarContainer=game.add.sprite(originalWidthCenter,250),this.avatarContainer.alpha=0,this.avatarContainer.timeline=new TimelineMax({repeat:-1,yoyo:!0}),this.avatarContainer.timeline.to(this.avatarContainer,1,{y:"-=20",ease:Power2.easeInOut}),this.avatarAnimation(),this.container.addChild(this.avatarContainer),this.notificationContainer=game.add.sprite(originalWidthCenter,originalHeightCenter),this.container.addChild(this.notificationContainer),this.textNotification=game.add.text(0,-45,"COMING SOON",{font:"27px Montserrat",fill:"#000000",align:"center"}),this.textNotification.anchor.set(.5),this.notificationContainer.addChild(this.textNotification),this.textAssurance=game.add.text(0,165,"* We won't share your address",{font:"22px Montserrat",fill:"#000000",align:"center"}),this.textAssurance.anchor.set(.5),this.notificationContainer.addChild(this.textAssurance),this.footer=game.add.sprite(originalWidthCenter,originalHeight-200),this.container.addChild(this.footer),this.btnVideo=new MenuButton(-100,0,170,100,{color:10724259,textColor:0,colorOver:16777215,textColorOver:0,format:{font:"bold 60px FontAwesome",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:0,radius:30,text:"",callback:b.bind(this)}),this.footer.addChild(this.btnVideo),this.textVideo=game.add.text(this.btnVideo.x,this.btnVideo.y+80,"GAME VIDEO",{font:"22px Montserrat",fill:"#000000",align:"center"}),this.textVideo.anchor.set(.5),this.footer.addChild(this.textVideo),this.btnFacebook=new MenuButton(130,0,100,100,{color:10724259,textColor:0,colorOver:16777215,textColorOver:0,format:{font:"bold 60px FontAwesome",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:0,radius:30,text:"",callback:c.bind(this)}),this.footer.addChild(this.btnFacebook),this.textFacebook=game.add.text(this.btnFacebook.x,this.btnFacebook.y+80,"FACEBOOK",{font:"22px Montserrat",fill:"#000000",align:"center"}),this.textFacebook.anchor.set(.5),this.footer.addChild(this.textFacebook),common.addLogo("logo",this.area),this.emailPlaceholderText="SIGN UP FOR UPDATE",this.emailPlaceholderFocusText="ENTER EMAIL ADDRESS",$("<form>").submit(function(a){a.preventDefault()}).appendTo("body"),$("<style>").appendTo("form"),detector.os()&&-1===detector.os().toLowerCase().indexOf("android")&&$('<button type="submit">').css({position:"absolute",margin:-1e3}).click(function(a){a.preventDefault()}).appendTo("form"),this.tbxMail=$('<input id="tbxMail" type="email">').appendTo("form").addClass("tbxMail").css({position:"absolute","background-color":common.toRgb(_.sample(palette)),"text-align":"center","font-family":"Montserrat, FontAwesome","font-weight":"bold"}).attr("placeholder",this.emailPlaceholderText).focusout(d.bind(this)).focusin(e.bind(this)).keydown(f.bind(this)).keyup(g.bind(this)).change(g.bind(this))},a.prototype.avatarAnimation=function(){this.avatarContainer.showTimeline&&(this.avatarContainer.avatar.destroy(),delete this.avatarContainer.avatar,this.avatarContainer.showTimeline.kill(),delete this.avatarContainer.showTimeline);var a=new TimelineMax({onComplete:this.avatarAnimation,onCompleteScope:this});this.avatarContainer.showTimeline=a;var b=game.add.sprite(0,0,_.sample(avatarNames)+"_head");b.anchor.set(.5),this.avatarContainer.avatar=b,this.avatarContainer.addChild(b),a.to(this.avatarContainer,1,{alpha:1,ease:Elastic.easeOut}),a.to(this.avatarContainer,1,{alpha:0,ease:Elastic.easeOut},"+=3")},a.prototype.hideMail=function(){this.tbxMail.hide().val(""),this.notificationContainer.kill()},a.prototype.showMail=function(){this.tbxMail.show(),this.notificationContainer.revive()},a.prototype.showThinking=function(){this.thinkingText=game.add.text(originalWidthCenter,originalHeightCenter,"Sending your information!",{font:"bold 55px Montserrat",fill:"#000000",align:"center"}),this.thinkingText.anchor.set(.5),this.container.addChild(this.thinkingText)},a.prototype.hideThinking=function(){this.thinkingText&&(this.thinkingText.destroy(),delete this.thinkingText)},a}(),board,mainState=function(){function a(){var a=.125*originalHeight;D=new com.speez.components.Header(originalWidth,a,{alpha:0});var d=game.add.text(50,.5*a,"",{font:"65px FontAwesome",fill:"#000000",align:"center"});d.anchor.set(.5),d.inputEnabled=!0,d.events.onInputDown.add(o),D.addLeft(d),u=new com.LayoutArea(0,0,originalWidth,originalHeight),container=game.add.sprite(),u.attach(container,{width:originalWidth,height:originalHeight,onResize:l}),game.stage.backgroundColor=14869218,w=game.add.sprite(originalWidthCenter,125,"logo"),w.anchor.set(.5),container.addChild(w),x=game.add.sprite(originalWidthCenter,310,"logoO"),x.anchor.set(.5),container.addChild(x);var a=100;D=new com.speez.components.Header(originalWidth,a,{alpha:0}),config.isPlayer?b():c(),config.isLocal}function b(){var a={color:14869218,textColor:0,colorOver:0,textColorOver:14803425,format:{font:"bold 44px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:0,radius:5};y=new MenuButton(0,746,486,128,_.extend({callback:n,text:"CREATE A GAME"},a));var b={font:"27px Montserrat",fill:"#000000",align:"center"},c=game.add.text(0,420,"JOIN THE GAME",b);c.anchor.set(.5);var d=game.add.text(0,650,"OR",b);d.anchor.set(.5),v=game.add.group(),v.add(y),v.add(c),v.add(d),v.x=originalWidthCenter,v.y=0,container.addChild(v),$("<form>").submit(function(a){a.preventDefault()}).appendTo("body"),$("<style>").appendTo("form").text("input::-webkit-input-placeholder { font-size: 60 }"),detector.os()&&-1===detector.os().toLowerCase().indexOf("android")&&$('<button type="submit">').css({position:"absolute",margin:-1e3}).click(function(a){a.preventDefault()}).appendTo("form"),$('<input id="tbxJoin" type="text">').appendTo("form").addClass("tbxJoin").css({position:"absolute","background-color":common.toRgb(_.sample(palette)),"text-align":"center","font-family":"Montserrat, FontAwesome"}).attr("placeholder","").focusout(g).focusin(h).keydown(i).keyup(j).change(j),detector.os()&&-1===detector.os().toLowerCase().indexOf("android")&&($("#tbxJoin").on("touchstart",function(){$(this).attr("type","number")}),$("#tbxJoin").on("blur",function(){$(this).attr("type","text")}))}function c(){var a={font:"50px Montserrat",fill:"#000000",align:"center"},b=game.add.text(originalWidthCenter,originalHeightCenter,"Connecting to Game Server",a);b.anchor.set(.5),container.addChild(b)}function d(){var a=game.add.text(originalWidthCenter,100,"HELP ME",{font:"bold 50px Montserrat",fill:"#ffffff",align:"center"});a.anchor.set(.5);var b="1. Enter the address\n   SPEEZ.CO from any\n   Device - (PC/Smartphone\n   Tablet) and\n   CREATE A GAME.\n\n2. Enter the address\n    SPEEZ.CO from any\n    other Device and\n    JOIN THE GAME.\n",c=game.add.text(0,200,b,{font:"bold 35px Montserrat",fill:"#ffffff",align:"left"});c.x=originalWidthCenter-c.width/2;var d=new MenuButton(originalWidthCenter,705,324,64,{color:1973790,textColor:16777215,colorOver:16777215,textColorOver:0,format:{font:"bold 30px FontAwesome",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"",callback:p}),e=new MenuButton(originalWidthCenter,830,324,96,{color:39935,textColor:1973790,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"GOT IT",callback:q});E=new com.speez.components.PauseScreen(originalWidth,originalHeight),game.add.existing(E),E.container.addChild(a),E.container.addChild(c),E.container.addChild(e),E.container.addChild(d)}function e(){z=new MenuButton(w.x,w.y,300,60,_.extend({callback:r,text:"T.P"})),A=new MenuButton(w.x,w.y+60,300,60,_.extend({callback:s,text:"T.S"})),game.add.existing(z),game.add.existing(A)}function f(){C&&C.kill(),C=new TimelineMax({onComplete:function(a){a.timeline.kill(),a.destroy()},onCompleteParams:[B]}),B&&C.to(B,1,{alpha:0,ease:Elastic.easeIn}),B=game.add.sprite(originalWidthCenter,250,_.sample(avatarNames)+"_head"),B.alpha=0,B.anchor.set(.5),container.addChild(B),B.timeline=new TimelineMax({repeat:-1,yoyo:!0}),B.timeline.to(B,1,{y:"-=20",ease:Power2.easeInOut}),C.to(B,1,{alpha:1,ease:Elastic.easeOut}),C.add(f,4)}function g(){Layout.instance.enable=!0,_.delay(function(){Layout.instance.resize(game.width,game.height)},2e3),$("#tbxJoin").removeClass("focus").attr("placeholder","")}function h(){Layout.instance.enable=!1,$("#tbxJoin").addClass("focus").removeClass("error").attr("placeholder","ENTER GAME NUMBER")}function i(){}function j(a){if(13===a.keyCode){$("#tbxJoin").blur(),a.preventDefault();var b=parseInt($("#tbxJoin").val());return void(999!==b||z?b&&(socket.emit("speed:join",{id:b},t),m(!1)):e())}var c=$("#tbxJoin").val().replace(/[^0-9]/g,"").substring(0,4);return $("#tbxJoin").val(c),c}function k(){$("form").remove()}function l(){var a=466*Layout.instance.minScale,b=144*Layout.instance.minScale,c=container.x+(originalWidthCenter-5)*Layout.instance.minScale-.5*a,d=container.y+530*Layout.instance.minScale-.5*b;$("#tbxJoin").css({left:c+"px",top:d+"px",width:a*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px",height:b*(detector.mobile()&&"ios"===detector.os().toLowerCase()?.9:1)+"px","border-width":5*Layout.instance.minScale+"px","font-size":60*Layout.instance.minScale+"px","line-height":80*Layout.instance.minScale+"px"}),$("form style").text("input::-webkit-input-placeholder {font-size:"+60*Layout.instance.minScale+"px}\ninput.focus::-webkit-input-placeholder {font-size:"+33*Layout.instance.minScale+"px}\ninput.error::-webkit-input-placeholder {font-size:"+33*Layout.instance.minScale+"px}")}function m(a){$("#tbxJoin").prop("disabled",!a),v.callAll("setEnable",null,a)}function n(){m(!1),game.state.start("lobby")}function o(){m(!1),$("form").hide(),d()}function p(){common.open("https://www.youtube.com/watch?v=meak65zqfGE")}function q(){m(!0),$("form").show(),E.destroy()}function r(){var a=[12517592,14172416,14397184,10616576,51404,26047];a=_.shuffle(a),player={winner:!0,name:"Zeeps",game:{boardCount:4,hand:[],boards:[{color:a[0]},{color:a[1]},{color:a[2]},{color:a[3]}],cardCount:6,cardTotal:6},avatar:"Zeeps"},player.game.hand.push(1),player.game.hand.push(_.random(0,9)),player.game.hand.push(_.random(0,9)),player.game.hand.push(_.random(0,9)),player.game.hand.push(1),player.game.hand.push(_.random(0,9)),config.isTest=!0,setTimeout(function(){game.state.start("player")},1)}function s(){stage={game:{boardCount:4,boards:[]}};for(var a=0;a<stage.game.boardCount;a++)stage.game.boards[a]={current:_.random(0,9),previous:[]};config.isTest=!0,setTimeout(function(){game.state.start("stage")},1)}function t(a){return console.log("handleJoin:",a),a.confirm?(player={id:a.id,name:a.name,stageId:a.stageId,block:a.block,fazt:a.fazt,avatar:a.avatar},$("#tbxJoin").remove(),void game.state.start("lobbyPlayer")):($("#tbxJoin").blur().val("").addClass("error").attr("placeholder","GAME NOT FOUND"),void m(!0))}var u,v,w,x,y,z,A,B,C,D,E;return{preload:function(){common.flipOrientation("portrait"),layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1})},create:function(){a(),_.delay(f,200),common.addLogo("logo",u),common.addLogo("beta",u),common.addLogo("feedback",u),Layout.instance.resize(game.width,game.height),gameCount=0},shutdown:function(){k(),C&&C.kill()},resize:function(){console.log("gameResized")}}}(),playerState=function(){function a(){ab=.125*originalHeight,cb=25,bb=originalHeight-ab-cb,gameHeightCenter=bb/2,db=gameHeightCenter+ab,eb=150,fb=.5*eb,gb=originalWidth-eb,hb=bb/5,cardWidth=originalWidth-2*eb,Y=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),Z=game.add.sprite(),Y.attach(Z,{width:originalWidth,height:originalHeight}),W=[];for(var a=0;5>a;a++){var b=a%5,c=J(player.game.hand[b],b,!0,a>player.game.cardCount);W[b]=c}U=new com.speez.components.Header(originalWidth,ab,{text:L(),alpha:0});var d=game.add.text(50,.5*ab,"",{font:"65px FontAwesome",fill:"#ffffff",align:"center"});d.anchor.set(.5),d.inputEnabled=!0,d.events.onInputDown.add(h),U.addLeft(d);var e=game.add.sprite(-50,.5*ab,player.avatar+"_head");e.scale.set(.4),e.anchor.set(.5),U.addRight(e);var f=10;T=new com.speez.components.PlayerCardBar(0,originalHeight-(cb-f),originalWidth,cb-f),M()}function b(){c(),V=[],X=[];for(var a=0;a<player.game.boards.length;a++)X.push(player.game.boards[a].color);switch(player.game.boards.length){case 2:V[0]=new com.speez.components.PlayerBoard(0,ab,eb,bb,X[0]),V[1]=new com.speez.components.PlayerBoard(gb,ab,eb,bb,X[1]),X[2]=X[0],X[3]=X[1];break;case 3:V[0]=new com.speez.components.PlayerBoard(0,ab,eb,gameHeightCenter,X[0]),V[1]=new com.speez.components.PlayerBoard(gb,ab,eb,bb,X[1]),V[2]=new com.speez.components.PlayerBoard(0,db,eb,gameHeightCenter,X[2]),X[3]=X[1];break;case 4:V[0]=new com.speez.components.PlayerBoard(0,ab,eb,gameHeightCenter,X[0]),V[1]=new com.speez.components.PlayerBoard(gb,ab,eb,gameHeightCenter,X[1]),V[2]=new com.speez.components.PlayerBoard(0,db,eb,gameHeightCenter,X[2]),V[3]=new com.speez.components.PlayerBoard(gb,db,eb,gameHeightCenter,X[3])}}function c(){V&&_.each(V,function(a){a.destroy()})}function d(){var a=game.add.text(originalWidthCenter,215,"PAUZE",{font:"bold 50px FontAwesome",fill:"#ffffff",align:"center"});a.anchor.set(.5),pb=new MenuButton(originalWidthCenter,470,486,144,{color:39935,textColor:1973790,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"CONTINUE",callback:t}),qb=new MenuButton(originalWidthCenter,680,486,128,{color:1973790,textColor:16777215,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"END GAME",callback:u}),rb=new com.speez.components.PauseScreen(originalWidth,originalHeight),game.add.existing(rb),rb.container.addChild(a),rb.container.addChild(qb),rb.container.addChild(pb)}function e(a){return ib&&ib.destroy(),ib=new Phaser.Text(game,0,ab-25,a,{font:"40px Montserrat",fill:"#f2cb42",align:"center"}),ib.anchor.set(.5),U.addCenter(ib),ib}function f(a){return jb&&jb.destroy(),jb=new Phaser.Text(game,-50,.5*ab,a,{font:"80px FontAwesome",fill:"#f2cb42",align:"center"}),jb.anchor.set(.5),U.addRight(jb),jb}function g(a){player.block++,player.points+=a.points,e("YOU BLOCKED "+a.data.screw),ib.alpha=0;var b=new TimelineMax;b.to(ib,.75,{alpha:1},0),b.to(ib,.75,{alpha:0},3)}function h(){d(),_.invoke(W,"enable",!1)}function i(){return config.isTest?void N():void socket.emit("speed:player:loaded")}function j(a){sb[a.index]=a,Audio.instance.play("fx","card/pickup"),"play"===Q&&_.invoke(V,"setArrow"),mb=[],_.each(W,function(b){b&&b!==a&&b.faceup&&(b.reject(),G(b.card,a.card)&&(b.setOverlapSighted(),mb.push(b)))}),H(),kb=J(null,a.index,!1,player.game.cardCount<=5)}function k(a){delete sb[a.index],_.invoke(V,"cancelArrow"),lb=null,_.each(mb,function(a){a.cancelOverlapSighted()}),void 0!==a.thresholdHit&&"play"===Q?(_.invoke(W,"enable",!1),l(a,a.thresholdHit),Audio.instance.play("fx","card/placeBoard")):null!==a.overlap&&W[a.overlap]&&G(a.card,W[a.overlap].card)&&W[a.overlap].faceup?(_.invoke(W,"enable",!1),m(a,a.overlap),Audio.instance.play("fx","card/placeOverlap")):(a.returnCard(),H(),Audio.instance.play("fx","card/return"))}function l(a,b){a.placeCardBoard();var c=K(b);return board=V[c],board.setCard(),config.isTest?void P({boardId:c,handId:a.index}):void socket.emit("speed:player:cardBoard",{boardId:c,handId:a.index},z)}function m(a,b){return a.placeCardOverlap(),config.isTest?void O(a,b):void socket.emit("speed:player:cardOverlap",{overlapId:b,handId:a.index},y)}function n(a,b){if(lb&&(_.invoke(V,"cancelProximity"),lb.cancelOverlapped(),a.cancelOverlapping()),lb=null,void 0!==b){var c=W[b];if(!c||!c.faceup||!G(c.card,a.card))return void("play"===Q&&_.invoke(V,"setArrow"));lb=c,lb.setOverlapped(),a.setOverlapping(),_.invoke(V,"cancelArrow"),_.invoke(V,"setProximity",!1)}}function o(a,b){if("play"===Q)if(_.invoke(V,"cancelProximity"),void 0===b)_.invoke(V,"setArrow"),a.cancelProximity();else{_.invoke(V,"cancelArrow"),_.invoke(V,"setProximity",!1);var c=V[K(b)];c.setProximity(!0),c.setArrow(),a.setProximity(c.options.color)}}function p(){Q="play";var a=_.keys(sb);0!==a.length&&(lb||_.each(a,function(a){var b=sb[a];o(b,b.thresholdHit)}))}function q(){Q="speedy";var a=_.keys(sb);0!==a.length&&(_.invoke(V,"cancelProximity"),_.invoke(V,"cancelArrow"),_.each(a,function(a){var b=sb[a];b.cancelProximity()}))}function r(){return config.isTest?void D():void socket.emit("speed:player:next")}function s(){R=!R,R?(ob.setText(""),ob.options.color=3595850,ob.options.colorOver=S):(ob.setText("I'M READY"),ob.options.color=S,ob.options.colorOver=3595850);var a=new TimelineMax;a.add(common.tweenStageColor(R?3595850:S,function(){socket.emit("speed:player:ready",{isReady:R})},.75),0),a.add(ob.tweenColor(R?3595850:S,16777215),0),config.isTest}function t(){rb.destroy()}function u(){confirm("Are you sure?")&&(_.each(rb.container.children,function(a){a.setEnable&&a.setEnable(!1)}),socket.emit("speed:player:leave",B))}function v(b){console.log("handleStart:",b),a();var c=new TimelineLite({delay:1});if(c.add(_.invoke(W,"startCard"),0,null,0),c.add(_.invoke(W,"appearCard",!1),null,null,.2),config.isTest&&c.timeScale(9),config.isTest){var d=_.shuffle([12517592,14172416,14397184,10616576,51404,26047]),e=[];e[0]={color:d.pop()},e[1]={color:d.pop()},e[2]={color:d.pop()},e[3]={color:d.pop()},c.vars.onComplete=w,c.vars.onCompleteParams=[e]}}function w(a){console.log("handlePlay:",a),player.game.boards=a,b();var c=new TimelineMax;c.add(_.invoke(V,"appear",3355443)),c.add(p,c.totalDuration()/2),config.isTest}function x(a){if(console.log("handleSpeedy:",a),"finish"!==Q){q();var b=new TimelineMax;if(b.add(_.invoke(V,"disappear")),config.isTest){var c=_.shuffle([12517592,14172416,14397184,10616576,51404,26047]),d=[];d[0]={color:c.pop()},d[1]={color:c.pop()},d[2]={color:c.pop()},d[3]={color:c.pop()},b.vars.onComplete=w,b.vars.onCompleteParams=[d]}}}function y(a){if(console.log("handleCardOverlap:",a),"finish"!==Q){if(_.invoke(W,"enable",!0),_.invoke(V,"cancelProximity"),!a.confirm)return H(),_.invoke(W,"reject"),void Audio.instance.play("fx","card/reject");player.points+=a.points,I(W[a.handId]),W[a.overlapId].overlapComplete(),player.game.cardCount--,W[a.handId]=kb,kb.card=a.newCard;var b=kb.startCard();player.game.cardCount<5?kb.enable(!1):b.add(kb.appearCard()),kb=null,b.add(M(),0),Audio.instance.play("fx","card/overlapSuccess")}}function z(a){if(console.log("handleCardBoard:",a),"finish"!==Q){if(_.invoke(V,"cancelCard"),_.invoke(V,"cancelProximity"),!a.confirm){navigator.vibrate&&navigator.vibrate(2500),H(),_.invoke(W,"reject");var b=new TimelineLite,c=V[a.boardId].options.color,d=a.boardId%2===0;return b.add(W[a.handId].shake(d,c)),b.add(W[a.handId].shake(d,c),"-="+.75*W[a.handId].options.shakeTime),b.add(W[a.handId].shake(d,c),"-="+.75*W[a.handId].options.shakeTime),b.add(function(){_.invoke(W,"enable",!0)}),Audio.instance.play("fx","card/boardFailed"),void(a.screw&&(e(a.screw+" BLOCKED YOU"),f(""),ib.alpha=0,jb.alpha=0,$&&$.kill(),$=new TimelineMax,$.to([ib,jb],.75,{alpha:1}),$.add(common.tweenStageColor(7539969,null,.75),0),$.addLabel("screwOver",4),$.to([ib,jb],.75,{alpha:0},"screwOver"),$.add(common.tweenStageColor(1973790,.75),"screwOver-=1"),b.add($,0)))}player.points+=a.points;var g=V[a.boardId];g.setCardSuccess(),_.invoke(W,"enable",!0),I(W[a.handId]),player.game.cardCount--,W[a.handId]=kb,kb.card=a.newCard;var b=kb.startCard();player.game.cardCount<5?kb.enable(!1):b.add(kb.appearCard()),kb=null,b.add(M(),0),a.fazt&&(player.fazt++,e("FAZT ONE"),f(""),ib.alpha=0,jb.alpha=0,jb.x-=30,$&&$.kill(),$=new TimelineMax,$.to([ib,jb],.75,{alpha:1}),$.add(common.tweenStageColor(7405682,null,.75),0),$.addLabel("faztOver",4),$.to([ib,jb],.75,{alpha:0},"faztOver"),$.add(common.tweenStageColor(1973790,.75),"faztOver-=1"),b.add($,0)),Audio.instance.play("fx","card/boardSuccess")}}function A(a){console.log("handleAchievement:",a);var b=a.achievement;switch(b){case"screw":g(a)}}function B(a){console.log("handleLeave:",a),delete player,Audio.instance.stop("fx"),TweenMax.killAll();var b=new TimelineLite;b.to(_.flatten([W,V,Z,U]),1,{alpha:0}),b.add(common.tweenStageColor(0,function(){setTimeout(function(){game.state.start("main")},500)}))}function C(a){console.log("handleWinner:",a),Q="finish";var b=new TimelineLite({delay:1,onComplete:r}),c=1;player.game.winner=a.winner,player.points+=a.points,H(),T.flash(0),_.invoke(W,"reject"),_.invoke(W,"enable",!1),b.add(_.invoke(V,"disappear")),b.to(W,c,{alpha:0},"dissipate"),_gaq.push(["_trackEvent","speez","player","end"+gameCount])}function D(a){console.log("handleNext:",a),nb=game.add.text(originalWidthCenter,originalHeightCenter,"TEST",{font:"100px Montserrat",fill:"#ffffff",align:"center"}),nb.alpha=1,nb.anchor.set(.5),Z.addChild(nb);var b,c=new TimelineMax;player.game.winner?(nb.text="YOU WIN",S=39935,b="win/win"):(nb.text="YOU LOSE",S=13375489,b="lose/lose"),Audio.instance.play("fx",b);var d=70,e=game.add.text(originalWidthCenter,320,player.points.toString(),{font:"70px Montserrat",fill:"#ffffff",align:"center"});e.anchor.set(.5);var f=game.add.graphics();f.beginFill(16777215),f.drawRoundedRect(originalWidthCenter-135,380,270,15,25);var g=game.add.text(originalWidthCenter+d,480,player.block.toString(),{font:"55px Montserrat",fill:"#ffffff",align:"center"});g.anchor.set(.5);var h=game.add.text(originalWidthCenter-d,480,"",{font:"100px FontAwesome",fill:"#ffffff",align:"center"});h.anchor.set(.5);var i=game.add.text(originalWidthCenter+d,610,player.fazt.toString(),{font:"55px Montserrat",fill:"#ffffff",align:"center"});i.anchor.set(.5);var j=game.add.text(originalWidthCenter-d,610,"",{font:"100px FontAwesome",fill:"#ffffff",align:"center"});j.anchor.set(.5);var k=[e,f,g,h,i,j];_.each(k,function(a){a.alpha=0,Z.addChild(a)}),c.add(common.tweenStageColor(S,null,.75),0),c.to(nb,.75,{alpha:1},0),c.addLabel("delay","+=3"),c.to(k,2,{alpha:1}),config.isTest&&c.add(function(){E()},2)}function E(a){console.log("handleNextLobby:",a);var b={color:S,textColor:16777215,colorOver:2530868,textColorOver:16777215,colorDown:3595850,format:{font:"bold 44px Montserrat, FontAwesome",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:0,radius:10};ob=new MenuButton(originalWidthCenter,820,476,154,_.extend({callback:s,text:"I'M READY"},b)),ob.alpha=0,Z.addChild(ob);var c=new TimelineMax;c.to(ob,2,{alpha:1})}function F(a){console.log("handleLoad:",a),player.game=a,player.game.cardTotal=player.game.cardCount,game.state.start("player")}function G(a,b){return a===b}function H(){kb&&kb.destroy()}function I(a){a.enable(!1),_.delay(function(){a.destroy()},1e3*a.options.placeCardTime)}function J(a,b,c,d){if("finish"!==Q){var a=new com.speez.components.Card(b,eb,hb*b+ab,cardWidth,hb,{colors:X,waitCard:d?"speez"[b]:"+",textColor:d?2236962:15658734,isNew:c,card:a,dragStartCallback:j,dragStopCallback:k,heightOffset:ab});return a.overlapped.add(n),a.proximity.add(o),c||(a.options.startTime=.5,a.options.spinTime=.5),a}}function K(a){return 2===player.game.boards.length&&2===a?0:2===player.game.boards.length&&3===a?1:3===player.game.boards.length&&3===a?1:a}function L(){return player.name}function M(){var a=new TimelineMax;if(T.setProgress(1-player.game.cardCount/player.game.cardTotal),5!==player.game.cardCount&&1!==player.game.cardCount)return a;var b=1===player.game.cardCount?"LAST CARD":"LAST 5 CARDS";return e(b),ib.alpha=0,a.to(ib,.75,{alpha:1}),a.to(ib,.75,{alpha:0},4),T.flash(player.game.cardCount),Audio.instance.play("fx","achievement/last"+player.game.cardCount),a}function N(){v(),game.input.keyboard.onPressCallback=function(a,b){switch(b.charCode){case 113:A({achievement:"screw",data:{screw:"ZoZo"}});break;case 50:A({achievement:"test",data:{isGood:!0}})}}}function O(a,b){y({confirm:!0,newCard:_.random(0,9),handId:a.index,overlapId:b,newOverlapCard:a.card,points:50})}function P(a){var b=a.boardId,c=_.pick(a,["boardId","handId"]);if(b%2===0){var d=_.random(0,9);return 6===player.game.cardCount||2===player.game.cardCount,void(0===b?(z(_.extend({confirm:!0,newCard:d,fazt:_.random(0,1)>.5?!0:!1,points:100},c)),0===player.game.cardCount&&setTimeout(function(){C({winner:!0,points:1e3})},10)):setTimeout(function(){z(_.extend({confirm:!0,newCard:d,points:100},c)),setTimeout(function(){C({winner:!1,points:0})},10)},1e3))}3===b?setTimeout(function(){z(_.extend({confirm:!1},c))},1e3):z(_.extend({confirm:!1,screw:"ZoZo"},c))}var Q,R,S,T,U,V,W,X,Y,Z,$,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb=[];return{preload:function(){layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),Layout.instance.resize(game.width,game.height)},create:function(){common.tweenStageColor(1973790,i),Q="start",R=!1,player.points=0,player.block=0,player.fazt=0,gameCount++,_gaq.push(["_trackEvent","speez","player","start"+gameCount]),socket.on("speed:player:leave",B),socket.on("speed:player:speedy",x),socket.on("speed:player:play",w),socket.on("speed:player:start",v),socket.on("speed:player:winner",C),socket.on("speed:player:achieve",A),socket.on("speed:player:next",D),socket.on("speed:player:nextLobby",E),socket.on("speed:player:load",F)
},update:function(){},render:function(){config.isTest&&game.debug.cameraInfo(game.camera,32,32)},shutdown:function(){socket.off("speed:player:speedy",x),socket.off("speed:player:leave",B),socket.off("speed:player:play",w),socket.off("speed:player:start",v),socket.off("speed:player:achieve",A),socket.off("speed:player:winner",C),socket.off("speed:player:next",D),socket.off("speed:player:nextLobby",E),socket.off("speed:player:load",F)}}}(),playerFinishState=function(){function a(){m=.125*originalHeight,f=new com.speez.components.Header(originalWidth,m,{text:player.name,color:16777215}),h=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),g=game.add.sprite(),h.attach(g,{width:originalWidth,height:originalHeight}),i=game.add.text(originalWidthCenter,originalHeightCenter-30,player.game.winner?"YOU\nWIN":"YOU\nLOSE",{font:"200px Arial",fill:"#ffffff",align:"center"}),i.anchor.set(.5,.5),i.alpha=0,g.addChild(i),j=game.add.sprite(originalWidthCenter,originalHeightCenter+250),j.alpha=0,g.addChild(j),k=game.add.text(0,0,"Next Game:",{font:"25px Arial",fill:"#ffffff",align:"center"}),k.anchor.set(.5,.5),j.addChild(k),player.isReady=!1,l=new MenuButton(0,50,300,60,"Ready",b,{anchorX:.5,anchorY:.5}),j.addChild(l)}function b(){player.isReady=!player.isReady,l.setText(player.isReady?"Not Ready":"Ready"),socket.emit("speed:player:ready",{isReady:player.isReady})}function c(){Audio.instance.play("fx",player.game.winner?"win/win":"lose/lose");var a=new TimelineLite;a.to(i,.1,{alpha:1})}function d(){var a=new TimelineLite;a.to(j,1,{alpha:1,delay:2})}function e(a){player.game=a,player.game.cardTotal=player.game.cardCount;var b=new TimelineLite;b.add(common.tweenStageColor(16777215,function(){setTimeout(function(){game.state.start("player")},500)})),b.to(l,1,{alpha:0},0)}var f,g,h,i,j,k,l,m;return{preload:function(){layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),Layout.instance.resize(game.width,game.height)},create:function(){return a(),config.isTest?void c():(socket.on("speed:player:load",e),socket.on("speed:player:next",c),socket.on("speed:player:nextLobby",d),void socket.emit("speed:player:next"))},shutdown:function(){socket.off("speed:player:load",e),socket.off("speed:player:next",c),socket.off("speed:player:nextLobby",d)}}}(),preloadState=function(){function a(){e=new com.LayoutArea(0,0,originalWidth,originalHeight),d=game.add.sprite(),e.attach(d,{width:originalWidth,height:originalHeight});var a=game.add.sprite(originalWidthCenter,.5*originalHeightCenter,"logoGray");a.anchor.set(.5),d.addChild(a);var b=game.add.sprite(originalWidthCenter,originalHeightCenter+50,"logoO");b.anchor.set(.5),d.addChild(b);var c=game.add.sprite(originalWidthCenter,originalHeightCenter,"preloadAvatar");c.anchor.set(.5),d.addChild(c),f=game.add.text(originalWidthCenter,1.5*originalHeightCenter,"Preloading",{font:"bold 50px Montserrat",fill:"#58585a",align:"center"}),f.anchor.set(.5),d.addChild(f),g={progress:0}}function b(){f.text=Math.ceil(g.progress)+"%"}function c(){2===++h&&(console.error("VERSION "+config.version),console.error(config),game.state.start(config.isPlayer?"main":"lobby"))}var d,e,f,g,h=0;return{preload:function(){var b;config.isPackage?b=["style/font-awesome.min.css","style/fonts-package.css"]:(b=["style/font-awesome.min.css","style/fonts.css"],b=["style/font-awesome-package.min.css","style/fonts-package.css"]),WebFont.load({custom:{families:["FontAwesome","Montserrat"],urls:b},active:function(){c()},inactive:function(){console.log("Could not load font"),c()}}),layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),a(),Layout.instance.resize(game.width,game.height),game.load.image("lobbyDescription","images/lobby_description.png");for(var d=0;d<avatarNames.length;d++){var e=common.addZeroes(d+1,2);game.load.image(avatarNames[d],"images/avatar_"+e+".png"),game.load.image(avatarNames[d]+"_head","images/avatar_"+e+"_head.png")}},loadUpdate:function(){TweenMax.to(g,1,{progress:game.load.progress,onUpdate:b})},create:function(){f.text="Loading Fonts",game.add.text(-1e3,0,"",{font:"30px FontAwesome"}),c()},shutdown:function(){TweenMax.killTweensOf(g)}}}(),stageState;!function(){function a(){var a=70;O=new com.speez.components.Header(originalWidth,a,{alpha:0});var b=game.add.text(30,.5*a,"",{font:"20px FontAwesome",fill:"#ffffff",align:"center"});b.anchor.set(.5),b.inputEnabled=!0,b.events.onInputDown.add(c),O.addLeft(b),game.stage.backgroundColor=1973790,C=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),D=game.add.sprite(),C.attach(D,{width:originalWidth,height:originalHeight}),K=new com.speez.components.Rain({y:originalHeight+100,targetY:-100,maxX:originalWidth}),K.alpha=.3,game.add.existing(K),game.world.sendToBack(K),C.attach(K,{width:originalWidth,height:originalHeight,mode:Layout.PROPORTIONAL_OUTSIDE}),H=[],G=game.add.group(),G.x=originalWidthCenter,G.y=originalHeight-60,D.addChild(G);for(var d=_.keys(stage.players),f=0;f<d.length;f++){var g=stage.players[d[f]],h=new PlayerIcon(0,0,155,80,{isShowStats:!1});H[g.icon]=h,G.add(h),h.setPlayer(g,!1)}x(!1),timer=new com.speez.components.TimerLines({time:10,width:20,height:originalHeight,color:12961221,countComplete:e}),game.add.existing(timer),I=new com.speez.components.Incoming(originalWidthCenter,originalHeightCenter),D.addChild(I);var i=126;J=new com.speez.components.TextNotification(i,originalHeightCenter,originalWidth-2*i,200,{}),D.addChild(J),common.addLogo("beta",C)}function b(){d(),E=[],F=game.add.group();var a=100,b=140,c=-150,e=0,f={diffuseColor:game.stage.backgroundColor};switch(stage.game.boards.length){case 2:E[0]=new com.speez.components.StageBoard(.5*originalWidthCenter,originalHeightCenter+_.random(c,e),_.extend(f,{color:stage.game.boards[0].color,radius:_.random(a,b),rotateSpeed:100,isLeft:!0})),E[1]=new com.speez.components.StageBoard(1.5*originalWidthCenter,originalHeightCenter+_.random(c,e),_.extend(f,{color:stage.game.boards[1].color,radius:_.random(a,b),rotateSpeed:-100,isLeft:!1}));break;case 3:E[0]=new com.speez.components.StageBoard(0,0,originalWidthCenter,originalHeightCenter,stage.game.boards[0].color),E[1]=new com.speez.components.StageBoard(originalWidthCenter,0,originalWidthCenter,originalHeight,stage.game.boards[1].color),E[2]=new com.speez.components.StageBoard(0,originalHeightCenter,originalWidthCenter,originalHeightCenter,stage.game.boards[2].color);break;case 4:E[0]=new com.speez.components.StageBoard(0,0,originalWidthCenter,originalHeightCenter,stage.game.boards[0].color),E[1]=new com.speez.components.StageBoard(originalWidthCenter,0,originalWidthCenter,originalHeightCenter,stage.game.boards[1].color),E[2]=new com.speez.components.StageBoard(0,originalHeightCenter,originalWidthCenter,originalHeightCenter,stage.game.boards[2].color),E[3]=new com.speez.components.StageBoard(originalWidthCenter,originalHeightCenter,originalWidthCenter,originalHeightCenter,stage.game.boards[3].color)}_.each(E,function(a){D.addChild(a),a.options.appearTime=0})}function c(){var a=game.add.text(originalWidthCenter,143,"PAUZE",{font:"bold 50px FontAwesome",fill:"#ffffff",align:"center"});a.anchor.set(.5),M=new MenuButton(originalWidthCenter,313,324,96,{color:39935,textColor:1973790,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"CONTINUE",callback:g}),N=new MenuButton(originalWidthCenter,453,324,85,{color:1973790,textColor:16777215,colorOver:16777215,textColorOver:0,format:{font:"bold 30px Montserrat",fill:"#ffffff",align:"center"},borderWidth:5,borderColor:16777215,radius:5,text:"END GAME",callback:h}),L=new com.speez.components.PauseScreen(originalWidth,originalHeight),game.add.existing(L),L.container.addChild(a),L.container.addChild(N),L.container.addChild(M)}function d(){E&&_.each(E,function(a){a.destroy()})}function e(){v()}function f(){return config.isTest?void l(A()):void socket.emit("speed:stage:play",l)}function g(){L.destroy()}function h(){confirm("Are you sure?")&&(_.each(L.container.children,function(a){a.setEnable&&a.setEnable(!1)}),socket.emit("speed:stage:stageLeave",i))}function i(){delete stage,stage=null,game.state.start("main")}function j(){var a=[{text:"5",sound:"countdown/5"},{text:"4",sound:"countdown/4"},{text:"3",sound:"countdown/3"},{text:"2",sound:"countdown/2"},{text:"1",sound:"countdown/1"}],b=[{text:"SPEEZ",sound:"countdown/speed",angle:30}];config.isTest&&(a=[{text:"5",sound:"countdown/5"}]);var c={isTexts:!0,delay:1,size:300,delayBetween:1,effectOptions:{name:"speezIncoming",backRadius:650},format:{font:"bold 150px Montserrat",fill:"#111111",align:"center"},complete:f,timeScale:.9},d={isTexts:!0,format:{font:"bold 150px Montserrat",fill:"#111111",align:"center"},delay:1,size:150,delayBetween:.2,effectOptions:{name:"numericIncoming",backRadius:400},timeScale:1.7},e=new TimelineMax({delay:1});e.add(I.show(a,d),0),e.add(I.show(b,c),"+=1")}function k(a){console.log("handleSpeedy:",a);var b=[{text:"SPEEZ",sound:"countdown/speed",angle:30}],c={isTexts:!0,delay:1,size:300,delayBetween:1,effectOptions:{name:"speezIncoming",backRadius:650},format:{font:"bold 150px Montserrat",fill:"#111111",align:"center"},complete:f,timeScale:.9},d=new TimelineMax;d.add(function(){K.active=!1}),d.add(timer.disappear(),0),d.add(_.invoke(E,"disappear"),0),d.add(I.show(b,c),"+=1")}function l(a){console.log("handlePlay:",a),stage.game.boards=a,b();var c=new TimelineMax({});c.add(function(){K.active=!0}),c.add(w(),0),c.add(timer.appear(),0)}function m(a){console.log("handleCardBoard:",a);var b=stage.players[a.playerId],c=E[a.boardId];c.setCard(a.card,b.name,!0),D.removeChild(c),D.addChild(c),b.points+=a.points;var d=H[b.icon];d.tweenColor({color:c.options.color,isReturn:!0,returnTime:3}),d.setPoints(b.points),b.cardCount=a.cardCount,o(d,b);var e="";a.fazt&&(b.currentFazt++,e="",d.showIcon({symbol:e,symbolFormat:{font:"125px FontAwesome",fill:"#ffd646",align:"center"}})),d.popup({color:c.options.color,text:a.points.toString(),symbol:e,isStay:!1,stayTime:-.5}),timer.setCard(c.options.color)}function n(a){console.log("handleCardOverlap:",a);var b=stage.players[a.playerId];b.points+=a.points;var c=H[b.icon];c.setPoints(b.points),c.popup({color:16777215,text:a.points.toString(),symbol:"",isStay:!1,stayTime:-.5}),b.cardCount=a.cardCount,o(c,b)}function o(a,b){5===b.cardCount?a.flash(.5,60928):1===b.cardCount?a.flash(.2,15597568):0===b.cardCount&&a.flash(0,1973790),a.setCards(1-b.cardCount/stage.game.cardCount)}function p(a){console.log("handleAchieve:",a);var b=stage.players[a.player];a.points&&(b.points+=a.points),"screw"===a.achievement&&q(b,a)}function q(a,b){a.currentBlock++;var c=stage.players[b.data.screwId],d=H[c.icon];d.showIcon({symbol:"",symbolFormat:{font:"125px FontAwesome",fill:"#cb1800",align:"center"}}),a.points+=b.points;var d=H[a.icon];d.setPoints(a.points),d.tweenColor({color:13309952,isReturn:!0}),d.popup({color:13309952,text:b.points.toString(),symbol:"",isStay:!1,stayTime:-.5})}function r(a){console.log("handleLeave:",a),P&&P.kill(),delete stage.players[a.id],0===_.keys(stage.players).length&&(game.state.start("lobby"),Audio.instance.stop("fx"))}function s(a){console.log("handleNoMoves:",a),timer.noMoves()}function t(a){console.log("handleWinner:",a),stage.game.winnerData=a;var b=stage.players[a.winner];b.victories++,z();var c=new TimelineMax;P=c,c.add(function(){K.active=!1}),c.add(timer.disappear()),c.add(_.invoke(E,"disappear"),0);var d,e=[{text:"THE",color:16777215},{text:"WINNER",color:16777215},{text:b.name,color:39935}];if(d=H[b.icon],b.points+=stage.game.winnerData.points,c.addLabel("points","+=2"),c.add(function(){socket.emit("speed:stage:next")},"points"),c.add(J.show(e,"",null,{symbolColor:16777215,delayTime:5}),"points"),c.add(d.popup({color:39935,text:stage.game.winnerData.points.toString(),symbol:"",isStay:!1,stayTime:3}),"points"),c.add(d.setPoints(b.points),"points"),c.add(d.tweenColor({color:39935,isReturn:!0,returnTime:5}),"points"),stage.game.winnerData.bestBlocker){var f=stage.players[stage.game.winnerData.bestBlocker];d=H[f.icon],f.points+=stage.game.winnerData.bestBlockerPoints;var g=[{text:"BEST",color:16777215},{text:"BLOCKER",color:16777215},{text:f.name,color:13309952}];c.addLabel("bestBlocker","+=2"),c.add(J.show(g,"",f.currentBlock,{symbolColor:16777215,delayTime:3}),"bestBlocker"),c.add(d.popup({color:13309952,text:stage.game.winnerData.bestBlockerPoints.toString(),symbol:"",isStay:!1,stayTime:1}),"bestBlocker"),c.add(d.setPoints(f.points),"bestBlocker"),c.add(d.tweenColor({color:13309952,isReturn:!0,returnTime:3}),"bestBlocker")}if(stage.game.winnerData.bestFazt){var h=stage.players[stage.game.winnerData.bestFazt];d=H[h.icon],h.points+=stage.game.winnerData.bestFaztPoints;var i=[{text:"FAZT",color:16777215},{text:"ONE",color:16777215},{text:h.name,color:11927771}];c.addLabel("bestFazt","+=2"),c.add(J.show(i,"",h.currentFazt,{symbolColor:16777215,delayTime:3}),"bestFazt"),c.add(d.popup({color:11927771,text:stage.game.winnerData.bestFaztPoints.toString(),symbol:"",isStay:!1,stayTime:1}),"bestFazt"),c.add(d.setPoints(h.points),"bestFazt"),c.add(d.tweenColor({color:11927771,isReturn:!0,returnTime:3}),"bestFazt")}_gaq.push(["_trackEvent","speez","stage","end"+gameCount])}function u(a){console.log("handleNext:",a),P.to(G,1,{delay:1,y:210}),P.add(common.tweenStageColor(14869218,null,1)),P.add(function(){game.state.start("lobby")})}function v(){return config.isTest?void k():void socket.emit("speed:stage:speedy",null,k)}function w(){var a=new TimelineMax;b();for(var c=0;c<stage.game.boards.length;c++){E[c].setCard(stage.game.boards[c].current);var d=E[c].options.color;E[c].options.color=stage.game.boards[c].color,a.add(E[c].appear(d),0)}return a}function x(a){for(var b=200,c=new TimelineMax,d=0;d<H.length;d++){var e=H[d],f=.5*-b*(H.length-1)+d*b;c.to(e,1,{x:f},0)}return a||c.progress(1),c}function y(){var a=_.keys(stage.players);_.each(a,function(a){var b=stage.players[a];b.currentFazt=0,b.currentBlock=0})}function z(){var a=_.keys(stage.players);_.each(a,function(a){var b=stage.players[a];b.fazt+=b.currentFazt,b.block+=b.currentBlock;var c=H[b.icon];c.setCards(0)})}function A(){for(var a=[],b=_.shuffle([12517592,14172416,14397184,10616576,51404,26047]),c=0;c<stage.game.boardCount;c++)a[c]={current:_.random(0,9),color:b[c]};return a}function B(){stage.game.boardCount=2,stage.game.boards=A(),stage.game.cardCount=20,stage.players=[],stage.players[0]={id:0,name:"Zot",points:0,icon:0,cardCount:20,block:0,fazt:0,avatar:"Zot"},stage.players[1]={id:1,name:"Zeeps",points:0,icon:1,cardCount:20,block:0,fazt:0,avatar:"Zeeps"};game.input.keyboard.onPressCallback=function(a,b){switch(b.charCode){case 113:p({achievement:"firstOfGame",player:0,points:10});break;case 119:p({achievement:"screw",player:0,screwPlayerId:1,points:100});break;default:if(b.charCode>=48&&b.charCode<=57){var c=b.charCode-48,d=_.random(0,0),e=stage.players[d];e.cardCount--,m({card:c.toString(),fazt:_.random(0,1),boardId:_.random(0,stage.game.boardCount-1),playerId:d,cardCount:e.cardCount,points:100})}return}}}var C,D,E,F,G,H,I,J,K,L,M,N,O,P;stageState={preload:function(){common.flipOrientation("landscape"),layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),Layout.instance.resize(game.width,game.height)},create:function(){return config.isTest?(B(),a(),void j()):(gameCount++,_gaq.push(["_trackEvent","speez","stage","start"+gameCount]),y(),a(),socket.on("speed:stage:noMoves",s),socket.on("speed:stage:start",j),socket.on("speed:stage:cardBoard",m),socket.on("speed:stage:cardOverlap",n),socket.on("speed:stage:winner",t),socket.on("speed:stage:achieve",p),socket.on("speed:stage:leave",r),socket.on("speed:stage:next",u),void socket.emit("speed:stage:loaded"))},update:function(){},shutdown:function(){socket.off("speed:stage:noMoves",s),socket.off("speed:stage:leave",r),socket.off("speed:stage:achieve",p),socket.off("speed:stage:start",j),socket.off("speed:stage:cardBoard",m),socket.off("speed:stage:cardOverlap",n),socket.off("speed:stage:winner",t),socket.off("speed:stage:next",u)}}}();var stageFinishState=function(){function a(){f=new com.LayoutArea(0,0,originalWidth,originalHeight,{isDebug:!1}),e=game.add.sprite(),f.attach(e,{width:originalWidth,height:originalHeight}),console.log(stage.game.winner),console.log(stage.players);var a=stage.players[stage.game.winner];g=game.add.text(originalWidthCenter,originalHeightCenter,a.name,{font:"200px Arial",fill:"#ffffff",align:"center"}),g.alpha=0,g.anchor.set(.5,.5),e.addChild(g);var c=new TimelineLite({onComplete:b});c.to(g,.25,{alpha:1}),c.add(common.tweenStageColor(16777215),"+=5")}function b(){game.state.start("lobby")}function c(){a()}function d(a){delete stage.players[a.id]}var e,f,g;return{preload:function(){layout=new Layout({game:game,width:originalWidth,height:originalHeight,isDebug:!1}),Layout.instance.resize(game.width,game.height)},create:function(){return game.stage.backgroundColor=0,config.isTest?void c():(socket.on("speed:stage:next",c),socket.on("speed:stage:leave",d),void socket.emit("speed:stage:next"))},shutdown:function(){socket.off("speed:stage:leave",d),socket.off("speed:stage:next",c)}}}();
//# sourceMappingURL=speez.min.js.map